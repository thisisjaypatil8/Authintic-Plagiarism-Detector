{
    "sourceFile": "frontend/src/components/AnalysisReport.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 111,
            "patches": [
                {
                    "date": 1762593304616,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762596306723,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,97 +1,163 @@\n import React from 'react';\r\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n-import VisualReport from './VisualReport'; // Import our new component\r\n+import VisualReport from './VisualReport'; // We're keeping this\r\n+import DoughnutChart from './DoughnutChart'; // Import our new chart\r\n \r\n-// This component ONLY displays the results.\r\n-// It receives the 'result' and 'file' objects as props.\r\n+// This component receives the full 'result' and 'file' objects as props\r\n const AnalysisReport = ({ result, file }) => {\r\n+  // Extract the new stats object from the result\r\n+  const { stats, overall_score, full_text_structured, flagged_sections, full_text } = result;\r\n \r\n-    const handleDownloadPDF = () => {\r\n-        if (!result) return;\r\n+  const handleDownloadPDF = () => {\r\n+    // This function remains unchanged\r\n+    const doc = new jsPDF();\r\n+    const user = JSON.parse(localStorage.getItem('user'));\r\n+    \r\n+    doc.setFont('helvetica', 'bold');\r\n+    doc.setFontSize(20);\r\n+    doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n \r\n-        const doc = new jsPDF();\r\n-        const user = JSON.parse(localStorage.getItem('user'));\r\n-        \r\n-        doc.setFont('helvetica', 'bold');\r\n-        doc.setFontSize(20);\r\n-        doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n+    doc.setFont('helvetica', 'normal');\r\n+    doc.setFontSize(12);\r\n+    doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n+    doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n+    doc.text(`Date: ${new Date().toLocaleString()}`, 14, 49);\r\n \r\n-        doc.setFont('helvetica', 'normal');\r\n-        doc.setFontSize(12);\r\n-        doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n-        doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n-        doc.text(`Date: ${new Date().toLocaleDateString()}`, 14, 49);\r\n+    doc.setFont('helvetica', 'bold');\r\n+    doc.text('Overall Similarity Score:', 14, 60);\r\n+    doc.setFont('helvetica', 'bold');\r\n+    doc.setTextColor(211, 47, 47); // Red color\r\n+    doc.setFontSize(16);\r\n+    doc.text(`${overall_score}%`, 75, 60);\r\n+    \r\n+    doc.setTextColor(0, 0, 0); // Reset color\r\n+    doc.setFontSize(12);\r\n \r\n-        doc.setFont('helvetica', 'bold');\r\n-        doc.text('Overall Similarity Score:', 14, 60);\r\n-        doc.setFont('helvetica', 'bold');\r\n-        doc.setTextColor(211, 47, 47); // Red color\r\n-        doc.setFontSize(16);\r\n-        doc.text(`${result.overall_score}%`, 75, 60);\r\n-        \r\n-        doc.setTextColor(0, 0, 0); // Reset color\r\n-        doc.setFontSize(12);\r\n+    doc.setFont('helvetica', 'bold');\r\n+    doc.text('Flagged Sections:', 14, 75);\r\n \r\n-        doc.setFont('helvetica', 'bold');\r\n-        doc.text('Flagged Sections:', 14, 75);\r\n+    const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n+    const tableRows = [];\r\n \r\n-        const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n-        const tableRows = [];\r\n+    flagged_sections.forEach(section => {\r\n+      const row = [\r\n+        `${section.similarity}%`,\r\n+        section.type,\r\n+        section.text,\r\n+        section.source\r\n+      ];\r\n+      tableRows.push(row);\r\n+    });\r\n \r\n-        result.flagged_sections.forEach(section => {\r\n-            const row = [\r\n-                `${section.similarity}%`,\r\n-                section.type,\r\n-                section.text,\r\n-                section.source\r\n-            ];\r\n-            tableRows.push(row);\r\n-        });\r\n+    autoTable(doc, {\r\n+      startY: 80,\r\n+      head: [tableColumn],\r\n+      body: tableRows,\r\n+      theme: 'striped',\r\n+      headStyles: { fillColor: [41, 128, 185] },\r\n+    });\r\n \r\n-        autoTable(doc, {\r\n-            startY: 80,\r\n-            head: [tableColumn],\r\n-            body: tableRows,\r\n-            theme: 'striped',\r\n-            headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n-        });\r\n+    doc.addPage();\r\n+    doc.setFont('helvetica', 'bold');\r\n+    doc.setFontSize(16);\r\n+    doc.text('Full Submitted Text', 14, 20);\r\n+    \r\n+    doc.setFont('helvetica', 'normal');\r\n+    doc.setFontSize(9);\r\n+    const splitText = doc.splitTextToSize(full_text, 180);\r\n+    doc.text(splitText, 14, 30);\r\n \r\n-        doc.addPage();\r\n-        doc.setFont('helvetica', 'bold');\r\n-        doc.setFontSize(16);\r\n-        doc.text('Full Submitted Text', 14, 20);\r\n+    doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n+  };\r\n+\r\n+  return (\r\n+    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n+      <div className=\"flex justify-between items-center mb-6 border-b pb-6\">\r\n+        <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+        <button\r\n+          onClick={handleDownloadPDF}\r\n+          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n+        >\r\n+          Download Report (PDF)\r\n+        </button>\r\n+      </div>\r\n+      \r\n+      {/* --- NEW VISUAL SUMMARY SECTION --- */}\r\n+      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n         \r\n-        doc.setFont('helvetica', 'normal');\r\n-        doc.setFontSize(9);\r\n-        const splitText = doc.splitTextToSize(result.full_text, 180);\r\n-        doc.text(splitText, 14, 30);\r\n+        {/* Chart Section */}\r\n+        <div className=\"md:col-span-1 flex flex-col items-center justify-center\">\r\n+          {/* Relative container to center the text */}\r\n+          <div className=\"relative w-48 h-48\">\r\n+            <DoughnutChart \r\n+              direct={stats.direct_percent}\r\n+              paraphrased={stats.paraphrased_percent}\r\n+              original={stats.original_percent}\r\n+            />\r\n+            {/* Absolute centered text */}\r\n+            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n+              <span className=\"text-4xl font-bold text-red-600\">{overall_score}%</span>\r\n+              <span className=\"text-sm text-gray-500\">Similarity</span>\r\n+            </div>\r\n+          </div>\r\n+          \r\n+          {/* Legend */}\r\n+          <div className=\"mt-4 space-y-2 text-sm w-full max-w-xs\">\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"flex items-center\">\r\n+                <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n+                Original\r\n+              </span>\r\n+              <span className=\"font-medium\">{stats.original_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"flex items-center\">\r\n+                <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n+                Paraphrased\r\n+              </span>\r\n+              <span className=\"font-medium\">{stats.paraphrased_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"flex items-center\">\r\n+                <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n+                Direct Match\r\n+              </span>\r\n+              <span className=\"font-medium\">{stats.direct_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+          </div>\r\n+        </div>\r\n \r\n-        doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n-    };\r\n-\r\n-    return (\r\n-        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n-            <div className=\"flex justify-between items-center mb-4\">\r\n-                <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n-                <button\r\n-                    onClick={handleDownloadPDF}\r\n-                    className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n-                >\r\n-                    Download Report (PDF)\r\n-                </button>\r\n+        {/* Text Stats Section */}\r\n+        <div className=\"md:col-span-2 bg-gray-50 p-6 rounded-lg\">\r\n+          <h3 className=\"text-xl font-semibold mb-4\">Summary</h3>\r\n+          <div className=\"space-y-3\">\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Total Sentences:</span>\r\n+              <span className=\"font-bold text-gray-800\">{stats.total_sentences}</span>\r\n             </div>\r\n-            <div className=\"mb-6 border-b pb-4\">\r\n-                <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n-                <span className=\"ml-2 text-3xl font-bold text-red-600\">{result.overall_score}%</span>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Original Sentences:</span>\r\n+              <span className=\"font-bold text-green-600\">{stats.original_count}</span>\r\n             </div>\r\n-            \r\n-            {/* Render the new VisualReport component */}\r\n-            {result.full_text_structured && (\r\n-                <VisualReport structuredText={result.full_text_structured} />\r\n-            )}\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Paraphrased Sentences:</span>\r\n+              <span className=\"font-bold text-yellow-600\">{stats.paraphrased_count}</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Direct Match Sentences:</span>\r\n+              <span className=\"font-bold text-red-600\">{stats.direct_count}</span>\r\n+            </div>\r\n+          </div>\r\n         </div>\r\n-    );\r\n+      </div>\r\n+      \r\n+      {/* Visual Report (this is our existing component) */}\r\n+      {full_text_structured && (\r\n+        <VisualReport structuredText={full_text_structured} />\r\n+      )}\r\n+    </div>\r\n+  );\r\n };\r\n \r\n export default AnalysisReport;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762599541481,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,162 +1,240 @@\n-import React from 'react';\r\n+import React, { useRef } from 'react';\r\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n-import VisualReport from './VisualReport'; // We're keeping this\r\n-import DoughnutChart from './DoughnutChart'; // Import our new chart\r\n+import DoughnutChart from './DoughnutChart';\r\n+import VisualReport from './VisualReport';\r\n \r\n-// This component receives the full 'result' and 'file' objects as props\r\n-const AnalysisReport = ({ result, file }) => {\r\n-  // Extract the new stats object from the result\r\n-  const { stats, overall_score, full_text_structured, flagged_sections, full_text } = result;\r\n+const AnalysisReport = ({ analysisResult, onRewrite }) => {\r\n+  // 1. Create a ref to hold the chart instance\r\n+  const chartRef = useRef(null);\r\n \r\n+  if (!analysisResult) {\r\n+    return null;\r\n+  }\r\n+\r\n+  const {\r\n+    overall_score,\r\n+    stats,\r\n+    flagged_sections,\r\n+    full_text_structured,\r\n+  } = analysisResult;\r\n+\r\n+  // --- NEW PDF DOWNLOAD LOGIC ---\r\n   const handleDownloadPDF = () => {\r\n-    // This function remains unchanged\r\n+    if (!analysisResult) return;\r\n+\r\n     const doc = new jsPDF();\r\n     const user = JSON.parse(localStorage.getItem('user'));\r\n-    \r\n+    const page = {\r\n+      width: doc.internal.pageSize.getWidth(),\r\n+      height: doc.internal.pageSize.getHeight(),\r\n+    };\r\n+    const margin = { top: 20, right: 14, bottom: 20, left: 14 };\r\n+\r\n+    // --- PAGE 1: SUMMARY & CHART ---\r\n+\r\n+    // 1. Title\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(20);\r\n-    doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n+    doc.text('Plagiarism Analysis Report', page.width / 2, margin.top, {\r\n+      align: 'center',\r\n+    });\r\n \r\n+    // 2. User Info\r\n     doc.setFont('helvetica', 'normal');\r\n     doc.setFontSize(12);\r\n-    doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n-    doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n-    doc.text(`Date: ${new Date().toLocaleString()}`, 14, 49);\r\n+    doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n \r\n+    // 3. Overall Score\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Overall Similarity Score:', 14, 60);\r\n+    doc.text('Overall Similarity Score:', margin.left, margin.top + 35);\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setTextColor(211, 47, 47); // Red color\r\n     doc.setFontSize(16);\r\n-    doc.text(`${overall_score}%`, 75, 60);\r\n+    doc.text(`${overall_score}%`, 75, margin.top + 35);\r\n+    doc.setTextColor(0, 0, 0); // Reset color\r\n+\r\n+    // 4. Add Chart Image\r\n+    if (chartRef.current) {\r\n+      const chartImage = chartRef.current.toBase64Image();\r\n+      // (Image, Format, X, Y, Width, Height)\r\n+      doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 45, 80, 80);\r\n+    }\r\n     \r\n-    doc.setTextColor(0, 0, 0); // Reset color\r\n+    // 5. Add Stats Summary Table\r\n+    autoTable(doc, {\r\n+      startY: margin.top + 135,\r\n+      head: [['Category', 'Sentences', 'Percentage']],\r\n+      body: [\r\n+        ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+        ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+        ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n+        ['Total Sentences', stats.total_sentences, '100.00%'],\r\n+      ],\r\n+      headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n+      foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n+      footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n+      theme: 'striped',\r\n+    });\r\n+\r\n+    // 6. Add Flagged Sections Table\r\n+    // The table might be long, so we get the 'finalY' from the last table\r\n+    const lastTableY = doc.lastAutoTable.finalY;\r\n     doc.setFontSize(12);\r\n-\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Flagged Sections:', 14, 75);\r\n+    doc.text('Flagged Sections Details:', margin.left, lastTableY + 15);\r\n \r\n-    const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n-    const tableRows = [];\r\n-\r\n-    flagged_sections.forEach(section => {\r\n-      const row = [\r\n+    autoTable(doc, {\r\n+      startY: lastTableY + 20,\r\n+      head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n+      body: flagged_sections.map((section) => [\r\n         `${section.similarity}%`,\r\n         section.type,\r\n         section.text,\r\n-        section.source\r\n-      ];\r\n-      tableRows.push(row);\r\n-    });\r\n-\r\n-    autoTable(doc, {\r\n-      startY: 80,\r\n-      head: [tableColumn],\r\n-      body: tableRows,\r\n+        section.source,\r\n+      ]),\r\n+      headStyles: { fillColor: [41, 128, 185] },\r\n       theme: 'striped',\r\n-      headStyles: { fillColor: [41, 128, 185] },\r\n     });\r\n \r\n+    // --- NEW PAGE: FULL TEXT APPENDIX ---\r\n     doc.addPage();\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(16);\r\n-    doc.text('Full Submitted Text', 14, 20);\r\n-    \r\n+    doc.text('Appendix: Full Submitted Text (with Highlighting)', margin.left, margin.top);\r\n+\r\n+    // --- CUSTOM TEXT RENDERER WITH HIGHLIGHTING & PAGINATION ---\r\n     doc.setFont('helvetica', 'normal');\r\n-    doc.setFontSize(9);\r\n-    const splitText = doc.splitTextToSize(full_text, 180);\r\n-    doc.text(splitText, 14, 30);\r\n+    const fontSize = 10;\r\n+    const lineHeight = fontSize * 0.35 * 1.5; // 10pt font, 1.5 line spacing\r\n+    doc.setFontSize(fontSize);\r\n \r\n-    doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n+    let currentX = margin.left;\r\n+    let currentY = margin.top + 15; // Start below appendix title\r\n+    const pageHeight = page.height - margin.bottom;\r\n+    const pageWidth = page.width - margin.right;\r\n+\r\n+    // Helper function for new pages\r\n+    const addNewPage = () => {\r\n+      doc.addPage();\r\n+      currentY = margin.top;\r\n+      doc.setFontSize(fontSize);\r\n+    };\r\n+    \r\n+    // Iterate over each structured sentence block\r\n+    full_text_structured.forEach((segment) => {\r\n+      const words = segment.text.split(' ');\r\n+      const spaceWidth = doc.getStringUnitWidth(' ') * fontSize / doc.internal.scaleFactor;\r\n+      \r\n+      // Set highlight color for this block\r\n+      let highlightColor = null;\r\n+      if (segment.plagiarized) {\r\n+        highlightColor = segment.type === 'Direct Match' ? [255, 99, 132] : [255, 206, 86]; // Red or Yellow\r\n+      }\r\n+\r\n+      words.forEach((word) => {\r\n+        const wordWidth = doc.getStringUnitWidth(word) * fontSize / doc.internal.scaleFactor;\r\n+\r\n+        // Check if word fits on the current line\r\n+        if (currentX + wordWidth > pageWidth) {\r\n+          // Word doesn't fit, move to next line\r\n+          currentX = margin.left;\r\n+          currentY += lineHeight;\r\n+        }\r\n+\r\n+        // Check if line fits on the current page\r\n+        if (currentY + lineHeight > pageHeight) {\r\n+          // Line doesn't fit, add a new page\r\n+          addNewPage();\r\n+        }\r\n+\r\n+        // 1. Draw highlight (if needed)\r\n+        if (highlightColor) {\r\n+          doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n+          // (X, Y, Width, Height, Style: 'F' = Fill)\r\n+          doc.rect(currentX, currentY - (lineHeight * 0.7), wordWidth, lineHeight, 'F');\r\n+        }\r\n+\r\n+        // 2. Draw text\r\n+        doc.setTextColor(0, 0, 0); // Black text\r\n+        doc.text(word, currentX, currentY);\r\n+\r\n+        // 3. Advance X position\r\n+        currentX += wordWidth + spaceWidth;\r\n+      });\r\n+      \r\n+      // Add a space after each segment (which is a sentence)\r\n+      currentX += spaceWidth;\r\n+    });\r\n+\r\n+    // 7. Save\r\n+    doc.save(`Plagiarism_Report.pdf`);\r\n   };\r\n \r\n   return (\r\n-    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n-      <div className=\"flex justify-between items-center mb-6 border-b pb-6\">\r\n-        <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+    <div className=\"bg-white p-6 rounded-lg shadow-md mt-8\">\r\n+      <div className=\"flex justify-between items-center mb-6 border-b pb-4\">\r\n+        <div>\r\n+          <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+          <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n+          <span className=\"ml-2 text-3xl font-bold text-red-600\">\r\n+            {overall_score}%\r\n+          </span>\r\n+        </div>\r\n         <button\r\n           onClick={handleDownloadPDF}\r\n-          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n+          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50\"\r\n         >\r\n           Download Report (PDF)\r\n         </button>\r\n       </div>\r\n-      \r\n-      {/* --- NEW VISUAL SUMMARY SECTION --- */}\r\n-      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n-        \r\n-        {/* Chart Section */}\r\n-        <div className=\"md:col-span-1 flex flex-col items-center justify-center\">\r\n-          {/* Relative container to center the text */}\r\n-          <div className=\"relative w-48 h-48\">\r\n-            <DoughnutChart \r\n-              direct={stats.direct_percent}\r\n-              paraphrased={stats.paraphrased_percent}\r\n-              original={stats.original_percent}\r\n-            />\r\n-            {/* Absolute centered text */}\r\n-            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n-              <span className=\"text-4xl font-bold text-red-600\">{overall_score}%</span>\r\n-              <span className=\"text-sm text-gray-500\">Similarity</span>\r\n-            </div>\r\n-          </div>\r\n-          \r\n-          {/* Legend */}\r\n-          <div className=\"mt-4 space-y-2 text-sm w-full max-w-xs\">\r\n-            <div className=\"flex justify-between\">\r\n+\r\n+      {/* Stats and Chart */}\r\n+      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 items-center\">\r\n+        {/* Chart */}\r\n+        <div className=\"h-64\">\r\n+          <DoughnutChart ref={chartRef} stats={stats} />\r\n+        </div>\r\n+\r\n+        {/* Stats Table */}\r\n+        <div>\r\n+          <h3 className=\"text-lg font-semibold mb-3\">Analysis Breakdown</h3>\r\n+          <ul className=\"space-y-2\">\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n                 Original\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.original_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n+              <span className=\"font-medium\">{stats.original_count} ({stats.original_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n                 Paraphrased\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.paraphrased_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n+              <span className=\"font-medium\">{stats.paraphrased_count} ({stats.paraphrased_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n                 Direct Match\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.direct_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-          </div>\r\n+              <span className=\"font-medium\">{stats.direct_count} ({stats.direct_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 border-t mt-2\">\r\n+              <span className=\"font-semibold\">Total Sentences</span>\r\n+              <span className=\"font-semibold\">{stats.total_sentences}</span>\r\n+            </li>\r\n+          </ul>\r\n         </div>\r\n+      </div>\r\n \r\n-        {/* Text Stats Section */}\r\n-        <div className=\"md:col-span-2 bg-gray-50 p-6 rounded-lg\">\r\n-          <h3 className=\"text-xl font-semibold mb-4\">Summary</h3>\r\n-          <div className=\"space-y-3\">\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Total Sentences:</span>\r\n-              <span className=\"font-bold text-gray-800\">{stats.total_sentences}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Original Sentences:</span>\r\n-              <span className=\"font-bold text-green-600\">{stats.original_count}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Paraphrased Sentences:</span>\r\n-              <span className=\"font-bold text-yellow-600\">{stats.paraphrased_count}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Direct Match Sentences:</span>\r\n-              <span className=\"font-bold text-red-600\">{stats.direct_count}</span>\r\n-            </div>\r\n-          </div>\r\n-        </div>\r\n-      </div>\r\n-      \r\n-      {/* Visual Report (this is our existing component) */}\r\n-      {full_text_structured && (\r\n-        <VisualReport structuredText={full_text_structured} />\r\n-      )}\r\n+      {/* Visual Report */}\r\n+      <VisualReport\r\n+        structuredText={full_text_structured}\r\n+        onRewrite={onRewrite}\r\n+      />\r\n     </div>\r\n   );\r\n };\r\n \r\n"
                },
                {
                    "date": 1762599955138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,240 +1,162 @@\n-import React, { useRef } from 'react';\r\n+import React from 'react';\r\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n-import DoughnutChart from './DoughnutChart';\r\n-import VisualReport from './VisualReport';\r\n+import VisualReport from './VisualReport'; // We're keeping this\r\n+import DoughnutChart from './DoughnutChart'; // Import our new chart\r\n \r\n-const AnalysisReport = ({ analysisResult, onRewrite }) => {\r\n-  // 1. Create a ref to hold the chart instance\r\n-  const chartRef = useRef(null);\r\n+// This component receives the full 'result' and 'file' objects as props\r\n+const AnalysisReport = ({ result, file }) => {\r\n+  // Extract the new stats object from the result\r\n+  const { stats, overall_score, full_text_structured, flagged_sections, full_text } = result;\r\n \r\n-  if (!analysisResult) {\r\n-    return null;\r\n-  }\r\n-\r\n-  const {\r\n-    overall_score,\r\n-    stats,\r\n-    flagged_sections,\r\n-    full_text_structured,\r\n-  } = analysisResult;\r\n-\r\n-  // --- NEW PDF DOWNLOAD LOGIC ---\r\n   const handleDownloadPDF = () => {\r\n-    if (!analysisResult) return;\r\n-\r\n+    // This function remains unchanged\r\n     const doc = new jsPDF();\r\n     const user = JSON.parse(localStorage.getItem('user'));\r\n-    const page = {\r\n-      width: doc.internal.pageSize.getWidth(),\r\n-      height: doc.internal.pageSize.getHeight(),\r\n-    };\r\n-    const margin = { top: 20, right: 14, bottom: 20, left: 14 };\r\n-\r\n-    // --- PAGE 1: SUMMARY & CHART ---\r\n-\r\n-    // 1. Title\r\n+    \r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(20);\r\n-    doc.text('Plagiarism Analysis Report', page.width / 2, margin.top, {\r\n-      align: 'center',\r\n-    });\r\n+    doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n \r\n-    // 2. User Info\r\n     doc.setFont('helvetica', 'normal');\r\n     doc.setFontSize(12);\r\n-    doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n+    doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n+    doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n+    doc.text(`Date: ${new Date().toLocaleString()}`, 14, 49);\r\n \r\n-    // 3. Overall Score\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Overall Similarity Score:', margin.left, margin.top + 35);\r\n+    doc.text('Overall Similarity Score:', 14, 60);\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setTextColor(211, 47, 47); // Red color\r\n     doc.setFontSize(16);\r\n-    doc.text(`${overall_score}%`, 75, margin.top + 35);\r\n+    doc.text(`${overall_score}%`, 75, 60);\r\n+    \r\n     doc.setTextColor(0, 0, 0); // Reset color\r\n+    doc.setFontSize(12);\r\n \r\n-    // 4. Add Chart Image\r\n-    if (chartRef.current) {\r\n-      const chartImage = chartRef.current.toBase64Image();\r\n-      // (Image, Format, X, Y, Width, Height)\r\n-      doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 45, 80, 80);\r\n-    }\r\n-    \r\n-    // 5. Add Stats Summary Table\r\n-    autoTable(doc, {\r\n-      startY: margin.top + 135,\r\n-      head: [['Category', 'Sentences', 'Percentage']],\r\n-      body: [\r\n-        ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n-        ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n-        ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n-        ['Total Sentences', stats.total_sentences, '100.00%'],\r\n-      ],\r\n-      headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n-      foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n-      footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n-      theme: 'striped',\r\n-    });\r\n-\r\n-    // 6. Add Flagged Sections Table\r\n-    // The table might be long, so we get the 'finalY' from the last table\r\n-    const lastTableY = doc.lastAutoTable.finalY;\r\n-    doc.setFontSize(12);\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Flagged Sections Details:', margin.left, lastTableY + 15);\r\n+    doc.text('Flagged Sections:', 14, 75);\r\n \r\n-    autoTable(doc, {\r\n-      startY: lastTableY + 20,\r\n-      head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n-      body: flagged_sections.map((section) => [\r\n+    const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n+    const tableRows = [];\r\n+\r\n+    flagged_sections.forEach(section => {\r\n+      const row = [\r\n         `${section.similarity}%`,\r\n         section.type,\r\n         section.text,\r\n-        section.source,\r\n-      ]),\r\n+        section.source\r\n+      ];\r\n+      tableRows.push(row);\r\n+    });\r\n+\r\n+    autoTable(doc, {\r\n+      startY: 80,\r\n+      head: [tableColumn],\r\n+      body: tableRows,\r\n+      theme: 'striped',\r\n       headStyles: { fillColor: [41, 128, 185] },\r\n-      theme: 'striped',\r\n     });\r\n \r\n-    // --- NEW PAGE: FULL TEXT APPENDIX ---\r\n     doc.addPage();\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(16);\r\n-    doc.text('Appendix: Full Submitted Text (with Highlighting)', margin.left, margin.top);\r\n-\r\n-    // --- CUSTOM TEXT RENDERER WITH HIGHLIGHTING & PAGINATION ---\r\n+    doc.text('Full Submitted Text', 14, 20);\r\n+    \r\n     doc.setFont('helvetica', 'normal');\r\n-    const fontSize = 10;\r\n-    const lineHeight = fontSize * 0.35 * 1.5; // 10pt font, 1.5 line spacing\r\n-    doc.setFontSize(fontSize);\r\n+    doc.setFontSize(9);\r\n+    const splitText = doc.splitTextToSize(full_text, 180);\r\n+    doc.text(splitText, 14, 30);\r\n \r\n-    let currentX = margin.left;\r\n-    let currentY = margin.top + 15; // Start below appendix title\r\n-    const pageHeight = page.height - margin.bottom;\r\n-    const pageWidth = page.width - margin.right;\r\n-\r\n-    // Helper function for new pages\r\n-    const addNewPage = () => {\r\n-      doc.addPage();\r\n-      currentY = margin.top;\r\n-      doc.setFontSize(fontSize);\r\n-    };\r\n-    \r\n-    // Iterate over each structured sentence block\r\n-    full_text_structured.forEach((segment) => {\r\n-      const words = segment.text.split(' ');\r\n-      const spaceWidth = doc.getStringUnitWidth(' ') * fontSize / doc.internal.scaleFactor;\r\n-      \r\n-      // Set highlight color for this block\r\n-      let highlightColor = null;\r\n-      if (segment.plagiarized) {\r\n-        highlightColor = segment.type === 'Direct Match' ? [255, 99, 132] : [255, 206, 86]; // Red or Yellow\r\n-      }\r\n-\r\n-      words.forEach((word) => {\r\n-        const wordWidth = doc.getStringUnitWidth(word) * fontSize / doc.internal.scaleFactor;\r\n-\r\n-        // Check if word fits on the current line\r\n-        if (currentX + wordWidth > pageWidth) {\r\n-          // Word doesn't fit, move to next line\r\n-          currentX = margin.left;\r\n-          currentY += lineHeight;\r\n-        }\r\n-\r\n-        // Check if line fits on the current page\r\n-        if (currentY + lineHeight > pageHeight) {\r\n-          // Line doesn't fit, add a new page\r\n-          addNewPage();\r\n-        }\r\n-\r\n-        // 1. Draw highlight (if needed)\r\n-        if (highlightColor) {\r\n-          doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n-          // (X, Y, Width, Height, Style: 'F' = Fill)\r\n-          doc.rect(currentX, currentY - (lineHeight * 0.7), wordWidth, lineHeight, 'F');\r\n-        }\r\n-\r\n-        // 2. Draw text\r\n-        doc.setTextColor(0, 0, 0); // Black text\r\n-        doc.text(word, currentX, currentY);\r\n-\r\n-        // 3. Advance X position\r\n-        currentX += wordWidth + spaceWidth;\r\n-      });\r\n-      \r\n-      // Add a space after each segment (which is a sentence)\r\n-      currentX += spaceWidth;\r\n-    });\r\n-\r\n-    // 7. Save\r\n-    doc.save(`Plagiarism_Report.pdf`);\r\n+    doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n   };\r\n \r\n   return (\r\n-    <div className=\"bg-white p-6 rounded-lg shadow-md mt-8\">\r\n-      <div className=\"flex justify-between items-center mb-6 border-b pb-4\">\r\n-        <div>\r\n-          <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n-          <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n-          <span className=\"ml-2 text-3xl font-bold text-red-600\">\r\n-            {overall_score}%\r\n-          </span>\r\n-        </div>\r\n+    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n+      <div className=\"flex justify-between items-center mb-6 border-b pb-6\">\r\n+        <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n         <button\r\n           onClick={handleDownloadPDF}\r\n-          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50\"\r\n+          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n         >\r\n           Download Report (PDF)\r\n         </button>\r\n       </div>\r\n-\r\n-      {/* Stats and Chart */}\r\n-      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 items-center\">\r\n-        {/* Chart */}\r\n-        <div className=\"h-64\">\r\n-          <DoughnutChart ref={chartRef} stats={stats} />\r\n-        </div>\r\n-\r\n-        {/* Stats Table */}\r\n-        <div>\r\n-          <h3 className=\"text-lg font-semibold mb-3\">Analysis Breakdown</h3>\r\n-          <ul className=\"space-y-2\">\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n+      \r\n+      {/* --- NEW VISUAL SUMMARY SECTION --- */}\r\n+      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n+        \r\n+        {/* Chart Section */}\r\n+        <div className=\"md:col-span-1 flex flex-col items-center justify-center\">\r\n+          {/* Relative container to center the text */}\r\n+          <div className=\"relative w-48 h-48\">\r\n+            <DoughnutChart \r\n+              direct={stats.direct_percent}\r\n+              paraphrased={stats.paraphrased_percent}\r\n+              original={stats.original_percent}\r\n+            />\r\n+            {/* Absolute centered text */}\r\n+            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n+              <span className=\"text-4xl font-bold text-red-600\">{overall_score}%</span>\r\n+              <span className=\"text-sm text-gray-500\">Similarity</span>\r\n+            </div>\r\n+          </div>\r\n+          \r\n+          {/* Legend */}\r\n+          <div className=\"mt-4 space-y-2 text-sm w-full max-w-xs\">\r\n+            <div className=\"flex justify-between\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n                 Original\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.original_count} ({stats.original_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n+              <span className=\"font-medium\">{stats.original_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n                 Paraphrased\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.paraphrased_count} ({stats.paraphrased_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n+              <span className=\"font-medium\">{stats.paraphrased_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n                 Direct Match\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.direct_count} ({stats.direct_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 border-t mt-2\">\r\n-              <span className=\"font-semibold\">Total Sentences</span>\r\n-              <span className=\"font-semibold\">{stats.total_sentences}</span>\r\n-            </li>\r\n-          </ul>\r\n+              <span className=\"font-medium\">{stats.direct_percent.toFixed(1)}%</span>\r\n+            </div>\r\n+          </div>\r\n         </div>\r\n+\r\n+        {/* Text Stats Section */}\r\n+        <div className=\"md:col-span-2 bg-gray-50 p-6 rounded-lg\">\r\n+          <h3 className=\"text-xl font-semibold mb-4\">Summary</h3>\r\n+          <div className=\"space-y-3\">\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Total Sentences:</span>\r\n+              <span className=\"font-bold text-gray-800\">{stats.total_sentences}</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Original Sentences:</span>\r\n+              <span className=\"font-bold text-green-600\">{stats.original_count}</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Paraphrased Sentences:</span>\r\n+              <span className=\"font-bold text-yellow-600\">{stats.paraphrased_count}</span>\r\n+            </div>\r\n+            <div className=\"flex justify-between\">\r\n+              <span className=\"text-gray-600\">Direct Match Sentences:</span>\r\n+              <span className=\"font-bold text-red-600\">{stats.direct_count}</span>\r\n+            </div>\r\n+          </div>\r\n+        </div>\r\n       </div>\r\n-\r\n-      {/* Visual Report */}\r\n-      <VisualReport\r\n-        structuredText={full_text_structured}\r\n-        onRewrite={onRewrite}\r\n-      />\r\n+      \r\n+      {/* Visual Report (this is our existing component) */}\r\n+      {full_text_structured && (\r\n+        <VisualReport structuredText={full_text_structured} />\r\n+      )}\r\n     </div>\r\n   );\r\n };\r\n \r\n"
                },
                {
                    "date": 1762600553281,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,162 +1,255 @@\n-import React from 'react';\r\n+import React, { useRef } from 'react';\r\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n-import VisualReport from './VisualReport'; // We're keeping this\r\n-import DoughnutChart from './DoughnutChart'; // Import our new chart\r\n+import DoughnutChart from './DoughnutChart';\r\n+import VisualReport from './VisualReport';\r\n \r\n-// This component receives the full 'result' and 'file' objects as props\r\n-const AnalysisReport = ({ result, file }) => {\r\n-  // Extract the new stats object from the result\r\n-  const { stats, overall_score, full_text_structured, flagged_sections, full_text } = result;\r\n+const AnalysisReport = ({ analysisResult }) => {\r\n+  // Create a ref to hold the chart instance\r\n+  const chartRef = useRef(null);\r\n \r\n+  if (!analysisResult) {\r\n+    return null;\r\n+  }\r\n+\r\n+  const {\r\n+    overall_score,\r\n+    stats,\r\n+    flagged_sections,\r\n+    full_text_structured,\r\n+  } = analysisResult;\r\n+\r\n+  // --- NEW PDF DOWNLOAD LOGIC ---\r\n   const handleDownloadPDF = () => {\r\n-    // This function remains unchanged\r\n+    if (!analysisResult) return;\r\n+\r\n     const doc = new jsPDF();\r\n     const user = JSON.parse(localStorage.getItem('user'));\r\n-    \r\n+    const page = {\r\n+      width: doc.internal.pageSize.getWidth(),\r\n+      height: doc.internal.pageSize.getHeight(),\r\n+    };\r\n+    const margin = { top: 20, right: 14, bottom: 20, left: 14 };\r\n+\r\n+    // --- PAGE 1: SUMMARY & CHART ---\r\n+\r\n+    // 1. Title\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(20);\r\n-    doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n+    doc.text('Plagiarism Analysis Report', page.width / 2, margin.top, {\r\n+      align: 'center',\r\n+    });\r\n \r\n+    // 2. User Info\r\n     doc.setFont('helvetica', 'normal');\r\n     doc.setFontSize(12);\r\n-    doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n-    doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n-    doc.text(`Date: ${new Date().toLocaleString()}`, 14, 49);\r\n+    doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n \r\n+    // 3. Overall Score\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Overall Similarity Score:', 14, 60);\r\n+    doc.text('Overall Similarity Score:', margin.left, margin.top + 35);\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setTextColor(211, 47, 47); // Red color\r\n     doc.setFontSize(16);\r\n-    doc.text(`${overall_score}%`, 75, 60);\r\n+    doc.text(`${overall_score}%`, 75, margin.top + 35);\r\n+    doc.setTextColor(0, 0, 0); // Reset color\r\n+\r\n+    // 4. Add Chart Image\r\n+    if (chartRef.current) {\r\n+      try {\r\n+        const chartImage = chartRef.current.toBase64Image();\r\n+        doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 45, 80, 80);\r\n+      } catch (e) {\r\n+        console.error(\"Error adding chart image to PDF:\", e);\r\n+      }\r\n+    }\r\n     \r\n-    doc.setTextColor(0, 0, 0); // Reset color\r\n+    // 5. Add Stats Summary Table\r\n+    autoTable(doc, {\r\n+      startY: margin.top + 135,\r\n+      head: [['Category', 'Sentences', 'Percentage']],\r\n+      body: [\r\n+        ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+        ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+        ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n+        ['Total Sentences', stats.total_sentences, '100.00%'],\r\n+      ],\r\n+      headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n+      foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n+      footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n+      theme: 'striped',\r\n+    });\r\n+\r\n+    // 6. Add Flagged Sections Table\r\n+    const lastTableY = doc.lastAutoTable.finalY;\r\n     doc.setFontSize(12);\r\n-\r\n     doc.setFont('helvetica', 'bold');\r\n-    doc.text('Flagged Sections:', 14, 75);\r\n+    doc.text('Flagged Sections Details:', margin.left, lastTableY + 15);\r\n \r\n-    const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n-    const tableRows = [];\r\n-\r\n-    flagged_sections.forEach(section => {\r\n-      const row = [\r\n+    autoTable(doc, {\r\n+      startY: lastTableY + 20,\r\n+      head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n+      body: flagged_sections.map((section) => [\r\n         `${section.similarity}%`,\r\n         section.type,\r\n         section.text,\r\n-        section.source\r\n-      ];\r\n-      tableRows.push(row);\r\n-    });\r\n-\r\n-    autoTable(doc, {\r\n-      startY: 80,\r\n-      head: [tableColumn],\r\n-      body: tableRows,\r\n+        section.source,\r\n+      ]),\r\n+      headStyles: { fillColor: [41, 128, 185] },\r\n       theme: 'striped',\r\n-      headStyles: { fillColor: [41, 128, 185] },\r\n     });\r\n \r\n+    // --- NEW PAGE: FULL TEXT APPENDIX ---\r\n     doc.addPage();\r\n     doc.setFont('helvetica', 'bold');\r\n     doc.setFontSize(16);\r\n-    doc.text('Full Submitted Text', 14, 20);\r\n-    \r\n+    doc.text('Appendix: Full Submitted Text (with Highlighting)', margin.left, margin.top);\r\n+\r\n+    // --- CUSTOM TEXT RENDERER WITH HIGHLIGHTING & PAGINATION ---\r\n     doc.setFont('helvetica', 'normal');\r\n-    doc.setFontSize(9);\r\n-    const splitText = doc.splitTextToSize(full_text, 180);\r\n-    doc.text(splitText, 14, 30);\r\n+    const fontSize = 10;\r\n+    const lineHeight = fontSize * 0.35 * 1.5; // 10pt font, 1.5 line spacing\r\n+    doc.setFontSize(fontSize);\r\n \r\n-    doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n+    let currentX = margin.left;\r\n+    let currentY = margin.top + 15; // Start below appendix title\r\n+    const pageHeight = page.height - margin.bottom;\r\n+    const pageWidth = page.width - margin.right;\r\n+\r\n+    // Helper function for new pages\r\n+    const addNewPage = () => {\r\n+      doc.addPage();\r\n+      currentY = margin.top;\r\n+      doc.setFontSize(fontSize);\r\n+    };\r\n+    \r\n+    // Iterate over each structured sentence block\r\n+    full_text_structured.forEach((segment) => {\r\n+      // Split text to handle spaces and newlines\r\n+      const words = segment.text.split(/(\\s+)/);\r\n+      const spaceWidth = doc.getStringUnitWidth(' ') * fontSize / doc.internal.scaleFactor;\r\n+      \r\n+      let highlightColor = null;\r\n+      if (segment.plagiarized) {\r\n+        highlightColor = segment.type === 'Direct Match' ? [255, 99, 132] : [255, 206, 86]; // Red or Yellow\r\n+      }\r\n+\r\n+      words.forEach((word) => {\r\n+        if (!word) return; // Skip empty strings\r\n+        \r\n+        const wordWidth = doc.getStringUnitWidth(word) * fontSize / doc.internal.scaleFactor;\r\n+\r\n+        // Check for newlines\r\n+        if (word.includes('\\n')) {\r\n+          currentX = margin.left;\r\n+          currentY += lineHeight * (word.split('\\n').length - 1);\r\n+        }\r\n+\r\n+        // Check if word fits on the current line\r\n+        if (currentX + wordWidth > pageWidth) {\r\n+          // Word doesn't fit, move to next line\r\n+          currentX = margin.left;\r\n+          currentY += lineHeight;\r\n+        }\r\n+\r\n+        // Check if line fits on the current page\r\n+        if (currentY + lineHeight > pageHeight) {\r\n+          // Line doesn't fit, add a new page\r\n+          addNewPage();\r\n+        }\r\n+\r\n+        // 1. Draw highlight (if needed and not just whitespace)\r\n+        if (highlightColor && word.trim().length > 0) {\r\n+          doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n+          doc.rect(currentX, currentY - (lineHeight * 0.7) + 1, wordWidth, lineHeight, 'F');\r\n+        }\r\n+\r\n+        // 2. Draw text\r\n+        doc.setTextColor(0, 0, 0); // Black text\r\n+        doc.text(word, currentX, currentY);\r\n+\r\n+        // 3. Advance X position\r\n+        currentX += wordWidth;\r\n+      });\r\n+    });\r\n+\r\n+    // 7. Save\r\n+    doc.save(`Plagiarism_Report.pdf`);\r\n   };\r\n \r\n+  // This is the function that will be passed down to VisualReport\r\n+  const handleRewriteRequest = (sentence, index) => {\r\n+    // We can't actually *do* the rewrite from here,\r\n+    // so we need to pass this request up to the Dashboard\r\n+    // In a future step, we would pass 'onRewrite' from Dashboard down to here.\r\n+    // For now, this console.log shows it's hooked up.\r\n+    console.log(\"Requesting rewrite for:\", sentence, index);\r\n+  };\r\n+\r\n   return (\r\n-    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n-      <div className=\"flex justify-between items-center mb-6 border-b pb-6\">\r\n-        <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+    <div className=\"bg-white p-6 rounded-lg shadow-md mt-8\">\r\n+      <div className=\"flex justify-between items-center mb-6 border-b pb-4\">\r\n+        <div>\r\n+          <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+          <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n+          <span className=\"ml-2 text-3xl font-bold text-red-600\">\r\n+            {overall_score}%\r\n+          </span>\r\n+        </div>\r\n         <button\r\n           onClick={handleDownloadPDF}\r\n-          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n+          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50\"\r\n         >\r\n           Download Report (PDF)\r\n         </button>\r\n       </div>\r\n-      \r\n-      {/* --- NEW VISUAL SUMMARY SECTION --- */}\r\n-      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n-        \r\n-        {/* Chart Section */}\r\n-        <div className=\"md:col-span-1 flex flex-col items-center justify-center\">\r\n-          {/* Relative container to center the text */}\r\n-          <div className=\"relative w-48 h-48\">\r\n-            <DoughnutChart \r\n-              direct={stats.direct_percent}\r\n-              paraphrased={stats.paraphrased_percent}\r\n-              original={stats.original_percent}\r\n-            />\r\n-            {/* Absolute centered text */}\r\n-            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n-              <span className=\"text-4xl font-bold text-red-600\">{overall_score}%</span>\r\n-              <span className=\"text-sm text-gray-500\">Similarity</span>\r\n-            </div>\r\n-          </div>\r\n-          \r\n-          {/* Legend */}\r\n-          <div className=\"mt-4 space-y-2 text-sm w-full max-w-xs\">\r\n-            <div className=\"flex justify-between\">\r\n+\r\n+      {/* Stats and Chart */}\r\n+      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 items-center\">\r\n+        {/* Chart */}\r\n+        <div className=\"h-64\">\r\n+          <DoughnutChart ref={chartRef} stats={stats} />\r\n+        </div>\r\n+\r\n+        {/* Stats Table */}\r\n+        <div>\r\n+          <h3 className=\"text-lg font-semibold mb-3\">Analysis Breakdown</h3>\r\n+          <ul className=\"space-y-2\">\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n                 Original\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.original_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n+              <span className=\"font-medium\">{stats.original_count} ({stats.original_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n                 Paraphrased\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.paraphrased_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n+              <span className=\"font-medium\">{stats.paraphrased_count} ({stats.paraphrased_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n               <span className=\"flex items-center\">\r\n                 <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n                 Direct Match\r\n               </span>\r\n-              <span className=\"font-medium\">{stats.direct_percent.toFixed(1)}%</span>\r\n-            </div>\r\n-          </div>\r\n+              <span className=\"font-medium\">{stats.direct_count} ({stats.direct_percent.toFixed(1)}%)</span>\r\n+            </li>\r\n+            <li className=\"flex justify-between items-center p-2 border-t mt-2\">\r\n+              <span className=\"font-semibold\">Total Sentences</span>\r\n+              <span className=\"font-semibold\">{stats.total_sentences}</span>\r\n+            </li>\r\n+          </ul>\r\n         </div>\r\n+      </div>\r\n \r\n-        {/* Text Stats Section */}\r\n-        <div className=\"md:col-span-2 bg-gray-50 p-6 rounded-lg\">\r\n-          <h3 className=\"text-xl font-semibold mb-4\">Summary</h3>\r\n-          <div className=\"space-y-3\">\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Total Sentences:</span>\r\n-              <span className=\"font-bold text-gray-800\">{stats.total_sentences}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Original Sentences:</span>\r\n-              <span className=\"font-bold text-green-600\">{stats.original_count}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Paraphrased Sentences:</span>\r\n-              <span className=\"font-bold text-yellow-600\">{stats.paraphrased_count}</span>\r\n-            </div>\r\n-            <div className=\"flex justify-between\">\r\n-              <span className=\"text-gray-600\">Direct Match Sentences:</span>\r\n-              <span className=\"font-bold text-red-600\">{stats.direct_count}</span>\r\n-            </div>\r\n-          </div>\r\n-        </div>\r\n-      </div>\r\n-      \r\n-      {/* Visual Report (this is our existing component) */}\r\n-      {full_text_structured && (\r\n-        <VisualReport structuredText={full_text_structured} />\r\n-      )}\r\n+      {/* Visual Report */}\r\n+      <VisualReport\r\n+        structuredText={full_text_structured}\r\n+        onRewrite={handleRewriteRequest} // Pass the rewrite handler down\r\n+      />\r\n     </div>\r\n   );\r\n };\r\n \r\n"
                },
                {
                    "date": 1762601005389,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,256 +1,255 @@\n import React, { useRef } from 'react';\r\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n+import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n-import VisualReport from './VisualReport';\r\n \r\n-const AnalysisReport = ({ analysisResult }) => {\r\n-  // Create a ref to hold the chart instance\r\n-  const chartRef = useRef(null);\r\n+// This component ONLY displays the results.\r\n+// It receives the 'analysisResult' and 'file' objects as props.\r\n+const AnalysisReport = ({ analysisResult, file }) => {\r\n+    // 1. Create a ref to hold the chart instance\r\n+    const chartRef = useRef(null);\r\n \r\n-  if (!analysisResult) {\r\n-    return null;\r\n-  }\r\n+    // This check is important. It ensures we don't try to read 'null'\r\n+    if (!analysisResult) {\r\n+        return null; \r\n+    }\r\n \r\n-  const {\r\n-    overall_score,\r\n-    stats,\r\n-    flagged_sections,\r\n-    full_text_structured,\r\n-  } = analysisResult;\r\n+    const { stats, overall_score, full_text_structured, flagged_sections, full_text } = analysisResult;\r\n \r\n-  // --- NEW PDF DOWNLOAD LOGIC ---\r\n-  const handleDownloadPDF = () => {\r\n-    if (!analysisResult) return;\r\n+    const handleDownloadPDF = () => {\r\n+        const doc = new jsPDF();\r\n+        const user = JSON.parse(localStorage.getItem('user'));\r\n+        const page = {\r\n+            width: doc.internal.pageSize.getWidth(),\r\n+            height: doc.internal.pageSize.getHeight(),\r\n+        };\r\n+        const margin = { top: 20, right: 14, bottom: 20, left: 14 };\r\n \r\n-    const doc = new jsPDF();\r\n-    const user = JSON.parse(localStorage.getItem('user'));\r\n-    const page = {\r\n-      width: doc.internal.pageSize.getWidth(),\r\n-      height: doc.internal.pageSize.getHeight(),\r\n-    };\r\n-    const margin = { top: 20, right: 14, bottom: 20, left: 14 };\r\n+        // --- PAGE 1: SUMMARY & CHART ---\r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.setFontSize(20);\r\n+        doc.text('Plagiarism Analysis Report', page.width / 2, margin.top, {\r\n+            align: 'center',\r\n+        });\r\n \r\n-    // --- PAGE 1: SUMMARY & CHART ---\r\n+        doc.setFont('helvetica', 'normal');\r\n+        doc.setFontSize(12);\r\n+        doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n+        doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n+        doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n-    // 1. Title\r\n-    doc.setFont('helvetica', 'bold');\r\n-    doc.setFontSize(20);\r\n-    doc.text('Plagiarism Analysis Report', page.width / 2, margin.top, {\r\n-      align: 'center',\r\n-    });\r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.setTextColor(211, 47, 47); // Red color\r\n+        doc.setFontSize(16);\r\n+        doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n+        doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n-    // 2. User Info\r\n-    doc.setFont('helvetica', 'normal');\r\n-    doc.setFontSize(12);\r\n-    doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n+        // Add Chart Image\r\n+        if (chartRef.current) {\r\n+            const chartImage = chartRef.current.toBase64Image();\r\n+            doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 55, 80, 80);\r\n+        }\r\n+        \r\n+        // Add Stats Summary Table\r\n+        autoTable(doc, {\r\n+            startY: margin.top + 145,\r\n+            head: [['Category', 'Sentences', 'Percentage']],\r\n+            body: [\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+                ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n+                ['Total Sentences', stats.total_sentences, '100.00%'],\r\n+            ],\r\n+            headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n+            foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n+            footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n+            theme: 'striped',\r\n+        });\r\n \r\n-    // 3. Overall Score\r\n-    doc.setFont('helvetica', 'bold');\r\n-    doc.text('Overall Similarity Score:', margin.left, margin.top + 35);\r\n-    doc.setFont('helvetica', 'bold');\r\n-    doc.setTextColor(211, 47, 47); // Red color\r\n-    doc.setFontSize(16);\r\n-    doc.text(`${overall_score}%`, 75, margin.top + 35);\r\n-    doc.setTextColor(0, 0, 0); // Reset color\r\n+        // Add Flagged Sections Table\r\n+        const lastTableY = doc.lastAutoTable.finalY;\r\n+        doc.setFontSize(12);\r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.text('Flagged Sections Details:', margin.left, lastTableY + 15);\r\n \r\n-    // 4. Add Chart Image\r\n-    if (chartRef.current) {\r\n-      try {\r\n-        const chartImage = chartRef.current.toBase64Image();\r\n-        doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 45, 80, 80);\r\n-      } catch (e) {\r\n-        console.error(\"Error adding chart image to PDF:\", e);\r\n-      }\r\n-    }\r\n-    \r\n-    // 5. Add Stats Summary Table\r\n-    autoTable(doc, {\r\n-      startY: margin.top + 135,\r\n-      head: [['Category', 'Sentences', 'Percentage']],\r\n-      body: [\r\n-        ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n-        ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n-        ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n-        ['Total Sentences', stats.total_sentences, '100.00%'],\r\n-      ],\r\n-      headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n-      foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n-      footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n-      theme: 'striped',\r\n-    });\r\n+        autoTable(doc, {\r\n+            startY: lastTableY + 20,\r\n+            head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n+            body: flagged_sections.map((section) => [\r\n+                `${section.similarity}%`,\r\n+                section.type,\r\n+                section.text,\r\n+                section.source,\r\n+            ]),\r\n+            headStyles: { fillColor: [41, 128, 185] },\r\n+            theme: 'striped',\r\n+        });\r\n \r\n-    // 6. Add Flagged Sections Table\r\n-    const lastTableY = doc.lastAutoTable.finalY;\r\n-    doc.setFontSize(12);\r\n-    doc.setFont('helvetica', 'bold');\r\n-    doc.text('Flagged Sections Details:', margin.left, lastTableY + 15);\r\n+        // --- NEW PAGE: FULL TEXT APPENDIX ---\r\n+        doc.addPage();\r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.setFontSize(16);\r\n+        doc.text('Appendix: Full Submitted Text (with Highlighting)', margin.left, margin.top);\r\n \r\n-    autoTable(doc, {\r\n-      startY: lastTableY + 20,\r\n-      head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n-      body: flagged_sections.map((section) => [\r\n-        `${section.similarity}%`,\r\n-        section.type,\r\n-        section.text,\r\n-        section.source,\r\n-      ]),\r\n-      headStyles: { fillColor: [41, 128, 185] },\r\n-      theme: 'striped',\r\n-    });\r\n+        // --- CUSTOM TEXT RENDERER WITH HIGHLIGHTING & PAGINATION ---\r\n+        doc.setFont('helvetica', 'normal');\r\n+        const fontSize = 10;\r\n+        const lineHeight = fontSize * 0.35 * 1.5;\r\n+        doc.setFontSize(fontSize);\r\n \r\n-    // --- NEW PAGE: FULL TEXT APPENDIX ---\r\n-    doc.addPage();\r\n-    doc.setFont('helvetica', 'bold');\r\n-    doc.setFontSize(16);\r\n-    doc.text('Appendix: Full Submitted Text (with Highlighting)', margin.left, margin.top);\r\n+        let currentX = margin.left;\r\n+        let currentY = margin.top + 15;\r\n+        const pageHeight = page.height - margin.bottom;\r\n+        const pageWidth = page.width - margin.right;\r\n \r\n-    // --- CUSTOM TEXT RENDERER WITH HIGHLIGHTING & PAGINATION ---\r\n-    doc.setFont('helvetica', 'normal');\r\n-    const fontSize = 10;\r\n-    const lineHeight = fontSize * 0.35 * 1.5; // 10pt font, 1.5 line spacing\r\n-    doc.setFontSize(fontSize);\r\n-\r\n-    let currentX = margin.left;\r\n-    let currentY = margin.top + 15; // Start below appendix title\r\n-    const pageHeight = page.height - margin.bottom;\r\n-    const pageWidth = page.width - margin.right;\r\n-\r\n-    // Helper function for new pages\r\n-    const addNewPage = () => {\r\n-      doc.addPage();\r\n-      currentY = margin.top;\r\n-      doc.setFontSize(fontSize);\r\n-    };\r\n-    \r\n-    // Iterate over each structured sentence block\r\n-    full_text_structured.forEach((segment) => {\r\n-      // Split text to handle spaces and newlines\r\n-      const words = segment.text.split(/(\\s+)/);\r\n-      const spaceWidth = doc.getStringUnitWidth(' ') * fontSize / doc.internal.scaleFactor;\r\n-      \r\n-      let highlightColor = null;\r\n-      if (segment.plagiarized) {\r\n-        highlightColor = segment.type === 'Direct Match' ? [255, 99, 132] : [255, 206, 86]; // Red or Yellow\r\n-      }\r\n-\r\n-      words.forEach((word) => {\r\n-        if (!word) return; // Skip empty strings\r\n+        const addNewPage = () => {\r\n+            doc.addPage();\r\n+            currentY = margin.top;\r\n+            doc.setFontSize(fontSize);\r\n+        };\r\n         \r\n-        const wordWidth = doc.getStringUnitWidth(word) * fontSize / doc.internal.scaleFactor;\r\n+        full_text_structured.forEach((segment) => {\r\n+            const words = segment.text.split(/(\\s+)/); // Split but keep whitespace\r\n+            \r\n+            let highlightColor = null;\r\n+            if (segment.plagiarized) {\r\n+                highlightColor = segment.type === 'Direct Match' ? [239, 68, 68] : [245, 158, 11]; // Red-500 or Yellow-600\r\n+            }\r\n \r\n-        // Check for newlines\r\n-        if (word.includes('\\n')) {\r\n-          currentX = margin.left;\r\n-          currentY += lineHeight * (word.split('\\n').length - 1);\r\n-        }\r\n+            words.forEach((word) => {\r\n+                if (!word) return;\r\n \r\n-        // Check if word fits on the current line\r\n-        if (currentX + wordWidth > pageWidth) {\r\n-          // Word doesn't fit, move to next line\r\n-          currentX = margin.left;\r\n-          currentY += lineHeight;\r\n-        }\r\n+                const wordWidth = doc.getStringUnitWidth(word) * fontSize / doc.internal.scaleFactor;\r\n \r\n-        // Check if line fits on the current page\r\n-        if (currentY + lineHeight > pageHeight) {\r\n-          // Line doesn't fit, add a new page\r\n-          addNewPage();\r\n-        }\r\n+                // Handle newlines explicitly\r\n+                if (word.includes('\\n')) {\r\n+                    const parts = word.split('\\n');\r\n+                    parts.forEach((part, i) => {\r\n+                        if (i > 0) { // If it's a part after a newline\r\n+                            currentX = margin.left;\r\n+                            currentY += lineHeight;\r\n+                            if (currentY + lineHeight > pageHeight) addNewPage();\r\n+                        }\r\n+                        const partWidth = doc.getStringUnitWidth(part) * fontSize / doc.internal.scaleFactor;\r\n+                        if (highlightColor && part.trim().length > 0) {\r\n+                            doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n+                            doc.rect(currentX, currentY - (lineHeight * 0.7) + 1, partWidth, lineHeight, 'F');\r\n+                        }\r\n+                        doc.setTextColor(0, 0, 0);\r\n+                        doc.text(part, currentX, currentY);\r\n+                        currentX += partWidth;\r\n+                    });\r\n+                } else {\r\n+                    // Word doesn't fit on the current line\r\n+                    if (currentX + wordWidth > pageWidth) {\r\n+                        currentX = margin.left;\r\n+                        currentY += lineHeight;\r\n+                    }\r\n+                    // Line doesn't fit on the current page\r\n+                    if (currentY + lineHeight > pageHeight) {\r\n+                        addNewPage();\r\n+                    }\r\n \r\n-        // 1. Draw highlight (if needed and not just whitespace)\r\n-        if (highlightColor && word.trim().length > 0) {\r\n-          doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n-          doc.rect(currentX, currentY - (lineHeight * 0.7) + 1, wordWidth, lineHeight, 'F');\r\n-        }\r\n+                    // Draw highlight\r\n+                    if (highlightColor && word.trim().length > 0) {\r\n+                        doc.setFillColor(highlightColor[0], highlightColor[1], highlightColor[2]);\r\n+                        doc.rect(currentX, currentY - (lineHeight * 0.7) + 1, wordWidth, lineHeight, 'F');\r\n+                    }\r\n \r\n-        // 2. Draw text\r\n-        doc.setTextColor(0, 0, 0); // Black text\r\n-        doc.text(word, currentX, currentY);\r\n+                    // Draw text\r\n+                    doc.setTextColor(0, 0, 0);\r\n+                    doc.text(word, currentX, currentY);\r\n+                    currentX += wordWidth;\r\n+                }\r\n+            });\r\n+        });\r\n \r\n-        // 3. Advance X position\r\n-        currentX += wordWidth;\r\n-      });\r\n-    });\r\n+        doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n+    };\r\n \r\n-    // 7. Save\r\n-    doc.save(`Plagiarism_Report.pdf`);\r\n-  };\r\n+    return (\r\n+        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n+            <div className=\"flex justify-between items-center mb-6 border-b pb-6\">\r\n+                <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n+                <button\r\n+                    onClick={handleDownloadPDF}\r\n+                    className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n+                >\r\n+                    Download Report (PDF)\r\n+                </button>\r\n+            </div>\r\n+            \r\n+            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n+                <div className=\"md:col-span-1 flex flex-col items-center justify-center\">\r\n+                    <div className=\"relative w-48 h-48\">\r\n+                        <DoughnutChart \r\n+                            ref={chartRef} // Pass the ref here\r\n+                            direct={stats.direct_percent}\r\n+                            paraphrased={stats.paraphrased_percent}\r\n+                            original={stats.original_percent}\r\n+                        />\r\n+                        <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n+                            <span className=\"text-4xl font-bold text-red-600\">{overall_score}%</span>\r\n+                            <span className=\"text-sm text-gray-500\">Similarity</span>\r\n+                        </div>\r\n+                    </div>\r\n+                    \r\n+                    <div className=\"mt-4 space-y-2 text-sm w-full max-w-xs\">\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"flex items-center\">\r\n+                                <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n+                                Original\r\n+                            </span>\r\n+                            <span className=\"font-medium\">{stats.original_percent.toFixed(1)}%</span>\r\n+                        </div>\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"flex items-center\">\r\n+                                <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n+                                Paraphrased\r\n+                            </span>\r\n+                            <span className=\"font-medium\">{stats.paraphrased_percent.toFixed(1)}%</span>\r\n+                        </div>\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"flex items-center\">\r\n+                                <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n+                                Direct Match\r\n+                            </span>\r\n+                            <span className=\"font-medium\">{stats.direct_percent.toFixed(1)}%</span>\r\n+                        </div>\r\n+                    </div>\r\n+                </div>\r\n \r\n-  // This is the function that will be passed down to VisualReport\r\n-  const handleRewriteRequest = (sentence, index) => {\r\n-    // We can't actually *do* the rewrite from here,\r\n-    // so we need to pass this request up to the Dashboard\r\n-    // In a future step, we would pass 'onRewrite' from Dashboard down to here.\r\n-    // For now, this console.log shows it's hooked up.\r\n-    console.log(\"Requesting rewrite for:\", sentence, index);\r\n-  };\r\n-\r\n-  return (\r\n-    <div className=\"bg-white p-6 rounded-lg shadow-md mt-8\">\r\n-      <div className=\"flex justify-between items-center mb-6 border-b pb-4\">\r\n-        <div>\r\n-          <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n-          <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n-          <span className=\"ml-2 text-3xl font-bold text-red-600\">\r\n-            {overall_score}%\r\n-          </span>\r\n+                <div className=\"md:col-span-2 bg-gray-50 p-6 rounded-lg\">\r\n+                    <h3 className=\"text-xl font-semibold mb-4\">Summary</h3>\r\n+                    <div className=\"space-y-3\">\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"text-gray-600\">Total Sentences:</span>\r\n+                            <span className=\"font-bold text-gray-800\">{stats.total_sentences}</span>\r\n+                        </div>\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"text-gray-600\">Original Sentences:</span>\r\n+                            <span className=\"font-bold text-green-600\">{stats.original_count}</span>\r\n+                        </div>\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"text-gray-600\">Paraphrased Sentences:</span>\r\n+                            <span className=\"font-bold text-yellow-600\">{stats.paraphrased_count}</span>\r\n+                        </div>\r\n+                        <div className=\"flex justify-between\">\r\n+                            <span className=\"text-gray-600\">Direct Match Sentences:</span>\r\n+                            <span className=\"font-bold text-red-600\">{stats.direct_count}</span>\r\n+                        </div>\r\n+                    </div>\r\n+                </div>\r\n+            </div>\r\n+            \r\n+            {full_text_structured && (\r\n+                <VisualReport structuredText={full_text_structured} />\r\n+            )}\r\n         </div>\r\n-        <button\r\n-          onClick={handleDownloadPDF}\r\n-          className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50\"\r\n-        >\r\n-          Download Report (PDF)\r\n-        </button>\r\n-      </div>\r\n-\r\n-      {/* Stats and Chart */}\r\n-      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 items-center\">\r\n-        {/* Chart */}\r\n-        <div className=\"h-64\">\r\n-          <DoughnutChart ref={chartRef} stats={stats} />\r\n-        </div>\r\n-\r\n-        {/* Stats Table */}\r\n-        <div>\r\n-          <h3 className=\"text-lg font-semibold mb-3\">Analysis Breakdown</h3>\r\n-          <ul className=\"space-y-2\">\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n-              <span className=\"flex items-center\">\r\n-                <span className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></span>\r\n-                Original\r\n-              </span>\r\n-              <span className=\"font-medium\">{stats.original_count} ({stats.original_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n-              <span className=\"flex items-center\">\r\n-                <span className=\"w-3 h-3 rounded-full bg-yellow-500 mr-2\"></span>\r\n-                Paraphrased\r\n-              </span>\r\n-              <span className=\"font-medium\">{stats.paraphrased_count} ({stats.paraphrased_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 bg-gray-50 rounded\">\r\n-              <span className=\"flex items-center\">\r\n-                <span className=\"w-3 h-3 rounded-full bg-red-500 mr-2\"></span>\r\n-                Direct Match\r\n-              </span>\r\n-              <span className=\"font-medium\">{stats.direct_count} ({stats.direct_percent.toFixed(1)}%)</span>\r\n-            </li>\r\n-            <li className=\"flex justify-between items-center p-2 border-t mt-2\">\r\n-              <span className=\"font-semibold\">Total Sentences</span>\r\n-              <span className=\"font-semibold\">{stats.total_sentences}</span>\r\n-            </li>\r\n-          </ul>\r\n-        </div>\r\n-      </div>\r\n-\r\n-      {/* Visual Report */}\r\n-      <VisualReport\r\n-        structuredText={full_text_structured}\r\n-        onRewrite={handleRewriteRequest} // Pass the rewrite handler down\r\n-      />\r\n-    </div>\r\n-  );\r\n+    );\r\n };\r\n \r\n export default AnalysisReport;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762601179891,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n     if (!analysisResult) {\r\n         return null; \r\n     }\r\n \r\n-    const { stats, overall_score, full_text_structured, flagged_sections, full_text } = analysisResult;\r\n+    const { stats, overall_score, full_text_structured, flagged_sections, full_tex } = analysisResult;\r\n \r\n     const handleDownloadPDF = () => {\r\n         const doc = new jsPDF();\r\n         const user = JSON.parse(localStorage.getItem('user'));\r\n"
                },
                {
                    "date": 1762610256082,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n     if (!analysisResult) {\r\n         return null; \r\n     }\r\n \r\n-    const { stats, overall_score, full_text_structured, flagged_sections, full_tex } = analysisResult;\r\n+    const { stats, overall_score, full_text_structured, flagged_sections } = analysisResult;\r\n \r\n     const handleDownloadPDF = () => {\r\n         const doc = new jsPDF();\r\n         const user = JSON.parse(localStorage.getItem('user'));\r\n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], \r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610263693,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], \r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how h\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610263839,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how h\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how how\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610269074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how how\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to ch\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610274348,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to ch\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to change th\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610280057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to change th\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to change the to green?\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610308324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,10 +56,10 @@\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n-            body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`], // how to change the to green?\r\n+            body: [ // how to change the to green?\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610320626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,8 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [ // how to change the to green?\r\n+            \r\n                 ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n"
                },
                {
                    "date": 1762610359028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,10 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [ // how to change the to green?\r\n-            \r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count,f `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610364104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [ // how to change the to green?\r\n-                ['Original', stats.original_count,f `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count,fil `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610369667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [ // how to change the to green?\r\n-                ['Original', stats.original_count,fil `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count,{f} `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610387777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,13 +56,13 @@\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n-            body: [ // how to change the to green?\r\n-                ['Original', stats.original_count,{f} `${stats.original_percent.toFixed(2)}%`],\r\n-                ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n-                ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n-                ['Total Sentences', stats.total_sentences, '100.00%'],\r\n+            body: [\r\n+                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Paraphrased', stats.paraphrased_count, { fillColor: [76, 175, 80] }, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+                ['Direct Match', stats.direct_count, { fillColor: [76, 175, 80] }, `${stats.direct_percent.toFixed(2)}%`],\r\n+                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610393019,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], /\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [76, 175, 80] }, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, { fillColor: [76, 175, 80] }, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610398542,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,10 +57,10 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], /\r\n-                ['Paraphrased', stats.paraphrased_count, { fillColor: [76, 175, 80] }, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n+                ['Paraphrased', stats.paraphrased_count, { fillColor: [76, 175, 80] }, `${stats.paraphrased_percent.toFixed(2)}%`],// Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [76, 175, 80] }, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n"
                },
                {
                    "date": 1762610406070,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,9 +58,9 @@\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n-                ['Paraphrased', stats.paraphrased_count, { fillColor: [76, 175, 80] }, `${stats.paraphrased_percent.toFixed(2)}%`],// Yellow\r\n+                ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [76, 175, 80] }, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n"
                },
                {
                    "date": 1762610414321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,9 @@\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n-                ['Direct Match', stats.direct_count, { fillColor: [76, 175, 80] }, `${stats.direct_percent.toFixed(2)}%`],\r\n+                ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n                 ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n"
                },
                {
                    "date": 1762610420774,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,9 +60,9 @@\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n-                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],\r\n+                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],//t\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610427583,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,9 +60,9 @@\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n-                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'],//t\r\n+                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'], // Green\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610440641,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,9 +60,9 @@\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n-                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'], // Green\r\n+                ['Total Sentences', stats.total_sentences, , '100.00%'], // Green\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610449202,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,9 +60,9 @@\n             body: [\r\n                 ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n                 ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n                 ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n-                ['Total Sentences', stats.total_sentences, , '100.00%'], // Green\r\n+                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'], // Green\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610625472,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,13 +56,13 @@\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n-            body: [\r\n-                ['Original', stats.original_count, { fillColor: [76, 175, 80] }, `${stats.original_percent.toFixed(2)}%`], // Green\r\n-                ['Paraphrased', stats.paraphrased_count, { fillColor: [245, 158, 11] }, `${stats.paraphrased_percent.toFixed(2)}%`], // Yellow\r\n-                ['Direct Match', stats.direct_count, { fillColor: [239, 68, 68] }, `${stats.direct_percent.toFixed(2)}%`], // Red\r\n-                ['Total Sentences', stats.total_sentences, { fillColor: [76, 175, 80] }, '100.00%'], // Green\r\n+            body: [ // how to change the to green?\r\n+                ['Original', stats.original_count,{fill} `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+                ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n+                ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n             foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n"
                },
                {
                    "date": 1762610630993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,9 +57,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [ // how to change the to green?\r\n-                ['Original', stats.original_count,{fill} `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count,fi `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762610643536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,10 +56,10 @@\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n-            body: [ // how to change the to green?\r\n-                ['Original', stats.original_count,fi `${stats.original_percent.toFixed(2)}%`],\r\n+            body: [\r\n+                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762611024763,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,8 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n+        \r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611035370,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        \r\n+        /\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611041084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        /\r\n+        //indicater\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611046689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        //indicater\r\n+        //indicato\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611051953,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        //indicato\r\n+        //indicators for the color sc\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611057468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        //indicators for the color sc\r\n+        //indicators for the color scheme use\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611063340,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,10 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-        //indicators for the color scheme use\r\n+        //indicators for the color scheme used in the chart\r\n+        \r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611071178,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,8 +44,9 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n+        doc.setTextColor(76, 175, 80); // Green color\r\n         \r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611077913,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n-        \r\n+        c\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611092995,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,10 +44,12 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n+        \r\n         doc.setTextColor(76, 175, 80); // Green color\r\n-        c\r\n+        doc.setTextColor(245, 158, 11); // Yellow color\r\n+        doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611103764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,9 +44,9 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n-        \r\n+        doc\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n"
                },
                {
                    "date": 1762611109685,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,10 +44,11 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n-        doc\r\n+        doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n+        \r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611116341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,10 +46,12 @@\n         doc.setFontSize(16);\r\n         //indicators for the color scheme used in the chart\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n-        \r\n+        doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n+        doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n+        doc.setFontSize(24);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611136077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,9 +49,9 @@\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n-        doc.setFontSize(24);\r\n+        \r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611141385,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,16 +42,15 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-        doc.setFontSize(16);\r\n+        \r\n         //indicators for the color scheme used in the chart\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n-        \r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611146815,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,8 +49,9 @@\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n+        \r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611162159,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,16 +42,16 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-        \r\n+    \r\n         //indicators for the color scheme used in the chart\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n-        \r\n+        doc.setFontSize(16);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611430468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,10 +42,10 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-    \r\n         //indicators for the color scheme used in the chart\r\n+        \r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n"
                },
                {
                    "date": 1762611435647,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,9 +43,9 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         //indicators for the color scheme used in the chart\r\n-        \r\n+        doc\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n"
                },
                {
                    "date": 1762611471691,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,10 +43,11 @@\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         //indicators for the color scheme used in the chart\r\n-        doc\r\n+        doc.setFontSize(12);\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n+        \r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611477610,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         //indicators for the color scheme used in the chart\r\n         doc.setFontSize(12);\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n-        \r\n+        doc.setTextColor\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611484061,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         //indicators for the color scheme used in the chart\r\n         doc.setFontSize(12);\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n-        doc.setTextColor\r\n+        doc.text()\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611490325,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         //indicators for the color scheme used in the chart\r\n         doc.setFontSize(12);\r\n         doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n-        doc.text()\r\n+        doc.text('D')\r\n         doc.setTextColor(76, 175, 80); // Green color\r\n         doc.text('Original', margin.left + 80, margin.top + 70);\r\n         doc.setTextColor(245, 158, 11); // Yellow color\r\n         doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611531676,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,16 +42,9 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-        //indicators for the color scheme used in the chart\r\n-        doc.setFontSize(12);\r\n-        doc.text('Direct Match', margin.left + 80, margin.top + 60);\r\n-        doc.text('D')\r\n-        doc.setTextColor(76, 175, 80); // Green color\r\n-        doc.text('Original', margin.left + 80, margin.top + 70);\r\n-        doc.setTextColor(245, 158, 11); // Yellow color\r\n-        doc.text('Paraphrased', margin.left + 80, margin.top + 80);\r\n+       \r\n         doc.setFontSize(16);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611538874,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,11 +42,10 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-       \r\n         doc.setFontSize(16);\r\n-        doc.setTextColor(211, 47, 47); // Red color\r\n+\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611544424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,15 +37,13 @@\n         doc.setFontSize(12);\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n-\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n-\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611606429,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,14 +37,16 @@\n         doc.setFontSize(12);\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n+\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.text('Overall Similarity Score:', margin.left, margin.top + 45);\r\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n+        \r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611616785,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,9 +44,9 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n-        \r\n+        co\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611622143,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,9 +44,9 @@\n         doc.setFont('helvetica', 'bold');\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n-        co\r\n+        doc.setFontSize(12);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611634318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,8 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n+        doc.\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611643058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.\r\n+        doc.text('O')\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611651355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.text('O')\r\n+        doc.text('Original', margin.left + 100, margin.top + 60);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611657957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,8 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.text('Original', margin.left + 100, margin.top + 60);\r\n+        \r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611666698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,10 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.text('Original', margin.left + 100, margin.top + 60);\r\n-        \r\n+        doc.text('Paraphrased', margin.left + 100, margin.top + 70);\r\n+        doc.text('Direct Match', margin.left + 100, margin.top + 80); \r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611694084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,11 +45,11 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.text('Original', margin.left + 100, margin.top + 60);\r\n+        doc.text('Original', margin.left , margin.top + 60);\r\n         doc.text('Paraphrased', margin.left + 100, margin.top + 70);\r\n-        doc.text('Direct Match', margin.left + 100, margin.top + 80); \r\n+        doc.text('Direct Match', margin.left + 100, margin.top + 80);    \r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611700512,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,11 +45,11 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.text('Original', margin.left , margin.top + 60);\r\n-        doc.text('Paraphrased', margin.left + 100, margin.top + 70);\r\n-        doc.text('Direct Match', margin.left + 100, margin.top + 80);    \r\n+        doc.text('Original', margin.left, margin.top + 60);\r\n+        doc.text('Paraphrased', margin.left, margin.top + 70);\r\n+        doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762611734324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,8 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n+        \r\n         doc.text('Original', margin.left, margin.top + 60);\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611740571,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        \r\n+        doc.setTextColor\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611745697,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.setTextColor\r\n+        doc.setTextColor(0, 0, 0); // Reset colo\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611750803,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.setTextColor(0, 0, 0); // Reset colo\r\n+        doc.setTextColor(0, 0, 0); // green color\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611755893,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,9 +45,9 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.setTextColor(0, 0, 0); // green color\r\n+        doc.setTextColor(, 0, 0); // green color\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n"
                },
                {
                    "date": 1762611762793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,10 +45,11 @@\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n-        doc.setTextColor(, 0, 0); // green color\r\n+        doc.setTextColor(76, 175, 80); // green color\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n+        \r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n"
                },
                {
                    "date": 1762611768847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,10 +47,11 @@\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n         doc.text('Original', margin.left, margin.top + 60);\r\n-        \r\n+        doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n+        doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n"
                },
                {
                    "date": 1762611827702,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,8 +64,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n+                \r\n                 ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n"
                },
                {
                    "date": 1762611832783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                \r\n+                setFillColor\r\n                 ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n"
                },
                {
                    "date": 1762611848618,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,8 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                setFillColor\r\n                 ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n"
                },
                {
                    "date": 1762611924199,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original', margin.left, margin.top + 60);\r\n+        doc.text('Original:', margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611932388,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original:', margin.left, margin.top + 60);\r\n+        doc.text('Original: $', margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611938406,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original: $', margin.left, margin.top + 60);\r\n+        doc.text('Original: ``', margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611946604,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original: ``', margin.left, margin.top + 60);\r\n+        doc.text('Original: `', margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611952048,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original: `', margin.left, margin.top + 60);\r\n+        doc.text('Original:'``, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611957441,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original:'``, margin.left, margin.top + 60);\r\n+        doc.text('Original:'`$`, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762611991892,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original:'`$`, margin.left, margin.top + 60);\r\n+        doc.text('Original:'``, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762612001045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text('Original:'``, margin.left, margin.top + 60);\r\n+        doc.text(`Original: ${stats.original_percent.toFixed(2)}%`, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text('Paraphrased', margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text('Direct Match', margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762612065342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,11 +48,11 @@\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n         doc.text(`Original: ${stats.original_percent.toFixed(2)}%`, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n-        doc.text('Paraphrased', margin.left, margin.top + 70);\r\n+        doc.text(`Paraphrased: ${stats.paraphrased_percent.toFixed(2)}%`, margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-        doc.text('Direct Match', margin.left, margin.top + 80);\r\n+        doc.text(`Direct Match: ${stats.direct_percent.toFixed(2)}%`, margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n@@ -64,9 +64,9 @@\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences', 'Percentage']],\r\n             body: [\r\n-                ['Original', stats.original_count, `${stats.original_percent.toFixed(2)}%`],\r\n+                ['Original', stats.original_count, `],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762612084185,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,11 +62,11 @@\n         \r\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n-            head: [['Category', 'Sentences', 'Percentage']],\r\n+            head: [['Category', 'Sentences']],\r\n             body: [\r\n-                ['Original', stats.original_count, `],\r\n+                ['Original', stats.original_count],\r\n                 ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n"
                },
                {
                    "date": 1762612098195,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,9 +65,9 @@\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences']],\r\n             body: [\r\n                 ['Original', stats.original_count],\r\n-                ['Paraphrased', stats.paraphrased_count, `${stats.paraphrased_percent.toFixed(2)}%`],\r\n+                ['Paraphrased', stats.paraphrased_count],\r\n                 ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n                 ['Total Sentences', stats.total_sentences, '100.00%'],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n"
                },
                {
                    "date": 1762612107002,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,13 +66,13 @@\n             head: [['Category', 'Sentences']],\r\n             body: [\r\n                 ['Original', stats.original_count],\r\n                 ['Paraphrased', stats.paraphrased_count],\r\n-                ['Direct Match', stats.direct_count, `${stats.direct_percent.toFixed(2)}%`],\r\n-                ['Total Sentences', stats.total_sentences, '100.00%'],\r\n+                ['Direct Match', stats.direct_count],\r\n+                ['Total Sentences', stats.total_sentences],\r\n             ],\r\n             headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n-            foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count, `${(100 - stats.original_percent).toFixed(2)}%`]],\r\n+            foot: [['Total Plagiarized', stats.direct_count + stats.paraphrased_count]],\r\n             footStyles: { fillColor: [231, 76, 60] }, // Red footer\r\n             theme: 'striped',\r\n         });\r\n \r\n"
                },
                {
                    "date": 1762612216661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,8 +59,9 @@\n             const chartImage = chartRef.current.toBase64Image();\r\n             doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 55, 80, 80);\r\n         }\r\n         \r\n+        \r\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences']],\r\n"
                },
                {
                    "date": 1762612224302,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,11 @@\n             const chartImage = chartRef.current.toBase64Image();\r\n             doc.addImage(chartImage, 'PNG', page.width / 2 - 40, margin.top + 55, 80, 80);\r\n         }\r\n         \r\n-        \r\n+        doc.setFont('helvetica', 'bold');\r\n+        doc.setFontSize(14);\r\n+        doc.text('Statistical Summary:', margin.left, margin.top + 145);\r\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n             startY: margin.top + 145,\r\n             head: [['Category', 'Sentences']],\r\n"
                },
                {
                    "date": 1762612247957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n         doc.setFontSize(14);\r\n         doc.text('Statistical Summary:', margin.left, margin.top + 145);\r\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n-            startY: margin.top + 145,\r\n+            startY: margin.top + 14,\r\n             head: [['Category', 'Sentences']],\r\n             body: [\r\n                 ['Original', stats.original_count],\r\n                 ['Paraphrased', stats.paraphrased_count],\r\n"
                },
                {
                    "date": 1762612315161,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n         doc.setFontSize(14);\r\n         doc.text('Statistical Summary:', margin.left, margin.top + 145);\r\n         // Add Stats Summary Table\r\n         autoTable(doc, {\r\n-            startY: margin.top + 14,\r\n+            startY: margin.top + 150,\r\n             head: [['Category', 'Sentences']],\r\n             body: [\r\n                 ['Original', stats.original_count],\r\n                 ['Paraphrased', stats.paraphrased_count],\r\n@@ -88,9 +88,9 @@\n         autoTable(doc, {\r\n             startY: lastTableY + 20,\r\n             head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n             body: flagged_sections.map((section) => [\r\n-                `${section.similarity}%`,\r\n+                `${section.similarityto}%`,\r\n                 section.type,\r\n                 section.text,\r\n                 section.source,\r\n             ]),\r\n"
                },
                {
                    "date": 1762612320982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n         autoTable(doc, {\r\n             startY: lastTableY + 20,\r\n             head: [['Similarity', 'Type', 'Flagged Text', 'Source']],\r\n             body: flagged_sections.map((section) => [\r\n-                `${section.similarityto}%`,\r\n+                `${section.similarity.toFixed(2)}%`,\r\n                 section.type,\r\n                 section.text,\r\n                 section.source,\r\n             ]),\r\n"
                },
                {
                    "date": 1762612434729,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text(`Original: ${stats.original_percent.toFixed(2)}%`, margin.left, margin.top + 60);\r\n+        doc.text(`Original: ${stats.original_percent.toFixed()}%`, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n         doc.text(`Paraphrased: ${stats.paraphrased_percent.toFixed(2)}%`, margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n         doc.text(`Direct Match: ${stats.direct_percent.toFixed(2)}%`, margin.left, margin.top + 80);\r\n"
                },
                {
                    "date": 1762612485684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,8 +34,9 @@\n         });\r\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n+        \r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n@@ -46,13 +47,13 @@\n         doc.setFontSize(16);\r\n         doc.text(`${overall_score}%`, 75, margin.top + 45);\r\n         doc.setFontSize(12);\r\n         doc.setTextColor(76, 175, 80); // green color\r\n-        doc.text(`Original: ${stats.original_percent.toFixed()}%`, margin.left, margin.top + 60);\r\n+        doc.text(`Original: ${stats.original_percent.toFixed(1)}%`, margin.left, margin.top + 60);\r\n         doc.setTextColor(255, 152, 0); // Orange color\r\n-        doc.text(`Paraphrased: ${stats.paraphrased_percent.toFixed(2)}%`, margin.left, margin.top + 70);\r\n+        doc.text(`Paraphrased: ${stats.paraphrased_percent.toFixed(1)}%`, margin.left, margin.top + 70);\r\n         doc.setTextColor(211, 47, 47); // Red color\r\n-        doc.text(`Direct Match: ${stats.direct_percent.toFixed(2)}%`, margin.left, margin.top + 80);\r\n+        doc.text(`Direct Match: ${stats.direct_percent.toFixed(1)}%`, margin.left, margin.top + 80);\r\n         doc.setTextColor(0, 0, 0); // Reset color\r\n \r\n         // Add Chart Image\r\n         if (chartRef.current) {\r\n"
                },
                {
                    "date": 1762612490977,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n         });\r\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n-        \r\n+        //how to\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762612497336,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,10 @@\n         });\r\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n-        //how to\r\n+        // Add User Info\r\n+        d\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762612502894,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n         // Add User Info\r\n-        d\r\n+        doc\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762612511693,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n         // Add User Info\r\n-        doc\r\n+        doc.text()\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762612520354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n         // Add User Info\r\n-        doc.text()\r\n+        doc.text(``)\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762612525675,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n         // Add User Info\r\n-        doc.text(``)\r\n+        doc.text(`User ID: ${user?.id || 'N/A'}`, margin.left, margin.top + 13);\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762613769254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,15 @@\n     const { stats, overall_score, full_text_structured, flagged_sections } = analysisResult;\r\n \r\n     const handleDownloadPDF = () => {\r\n         const doc = new jsPDF();\r\n-        const user = JSON.parse(localStorage.getItem('user'));\r\n+        let user = null;\r\n+        try {\r\n+            const userStr = localStorage.getItem('user');\r\n+            user = userStr ? JSON.parse(userStr) : null;\r\n+        } catch (e) {\r\n+            user = null;\r\n+        }\r\n         const page = {\r\n             width: doc.internal.pageSize.getWidth(),\r\n             height: doc.internal.pageSize.getHeight(),\r\n         };\r\n"
                },
                {
                    "date": 1762613831340,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n \r\n+\r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n     // 1. Create a ref to hold the chart instance\r\n"
                },
                {
                    "date": 1762613836455,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,10 @@\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n+import \r\n \r\n-\r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n     // 1. Create a ref to hold the chart instance\r\n"
                },
                {
                    "date": 1762613845364,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n-import \r\n+import l\r\n \r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n"
                },
                {
                    "date": 1762613845626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n-import l\r\n+import loacal\r\n \r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n"
                },
                {
                    "date": 1762613851216,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n-import loacal\r\n+import localStorage\r\n \r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n"
                },
                {
                    "date": 1762613879209,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,10 @@\n import jsPDF from 'jspdf';\r\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n-import localStorage\r\n \r\n+\r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n     // 1. Create a ref to hold the chart instance\r\n"
                },
                {
                    "date": 1762613967098,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,8 @@\n import autoTable from 'jspdf-autotable';\r\n import VisualReport from './VisualReport';\r\n import DoughnutChart from './DoughnutChart';\r\n \r\n-\r\n // This component ONLY displays the results.\r\n // It receives the 'analysisResult' and 'file' objects as props.\r\n const AnalysisReport = ({ analysisResult, file }) => {\r\n     // 1. Create a ref to hold the chart instance\r\n"
                },
                {
                    "date": 1762613975205,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,15 +18,9 @@\n     const { stats, overall_score, full_text_structured, flagged_sections } = analysisResult;\r\n \r\n     const handleDownloadPDF = () => {\r\n         const doc = new jsPDF();\r\n-        let user = null;\r\n-        try {\r\n-            const userStr = localStorage.getItem('user');\r\n-            user = userStr ? JSON.parse(userStr) : null;\r\n-        } catch (e) {\r\n-            user = null;\r\n-        }\r\n+        const user = JSON.parse(localStorage.getItem('user'));\r\n         const page = {\r\n             width: doc.internal.pageSize.getWidth(),\r\n             height: doc.internal.pageSize.getHeight(),\r\n         };\r\n@@ -40,10 +34,9 @@\n         });\r\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n-        // Add User Info\r\n-        doc.text(`User ID: ${user?.id || 'N/A'}`, margin.left, margin.top + 13);\r\n+\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762614356177,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,8 @@\n         });\r\n \r\n         doc.setFont('helvetica', 'normal');\r\n         doc.setFontSize(12);\r\n-\r\n         doc.text(`Report for: ${user?.name || 'User'}`, margin.left, margin.top + 20);\r\n         doc.text(`Analyzed File: ${file?.name || 'N/A'}`, margin.left, margin.top + 27);\r\n         doc.text(`Date: ${new Date().toLocaleString()}`, margin.left, margin.top + 34);\r\n \r\n"
                },
                {
                    "date": 1762614541423,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,11 @@\n     const { stats, overall_score, full_text_structured, flagged_sections } = analysisResult;\r\n \r\n     const handleDownloadPDF = () => {\r\n         const doc = new jsPDF();\r\n-        const user = JSON.parse(localStorage.getItem('user'));\r\n+        // Support both shapes: either { name, token } OR { token, user: { name, ... } }\r\n+        const stored = JSON.parse(localStorage.getItem('user'));\r\n+        const user = stored?.user ? stored.user : stored;\r\n         const page = {\r\n             width: doc.internal.pageSize.getWidth(),\r\n             height: doc.internal.pageSize.getHeight(),\r\n         };\r\n"
                }
            ],
            "date": 1762593304616,
            "name": "Commit-0",
            "content": "import React from 'react';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport VisualReport from './VisualReport'; // Import our new component\r\n\r\n// This component ONLY displays the results.\r\n// It receives the 'result' and 'file' objects as props.\r\nconst AnalysisReport = ({ result, file }) => {\r\n\r\n    const handleDownloadPDF = () => {\r\n        if (!result) return;\r\n\r\n        const doc = new jsPDF();\r\n        const user = JSON.parse(localStorage.getItem('user'));\r\n        \r\n        doc.setFont('helvetica', 'bold');\r\n        doc.setFontSize(20);\r\n        doc.text('Plagiarism Analysis Report', 105, 20, { align: 'center' });\r\n\r\n        doc.setFont('helvetica', 'normal');\r\n        doc.setFontSize(12);\r\n        doc.text(`Report for: ${user?.name || 'User'}`, 14, 35);\r\n        doc.text(`Analyzed File: ${file?.name || 'N/A'}`, 14, 42);\r\n        doc.text(`Date: ${new Date().toLocaleDateString()}`, 14, 49);\r\n\r\n        doc.setFont('helvetica', 'bold');\r\n        doc.text('Overall Similarity Score:', 14, 60);\r\n        doc.setFont('helvetica', 'bold');\r\n        doc.setTextColor(211, 47, 47); // Red color\r\n        doc.setFontSize(16);\r\n        doc.text(`${result.overall_score}%`, 75, 60);\r\n        \r\n        doc.setTextColor(0, 0, 0); // Reset color\r\n        doc.setFontSize(12);\r\n\r\n        doc.setFont('helvetica', 'bold');\r\n        doc.text('Flagged Sections:', 14, 75);\r\n\r\n        const tableColumn = [\"Similarity\", \"Type\", \"Flagged Text\", \"Source\"];\r\n        const tableRows = [];\r\n\r\n        result.flagged_sections.forEach(section => {\r\n            const row = [\r\n                `${section.similarity}%`,\r\n                section.type,\r\n                section.text,\r\n                section.source\r\n            ];\r\n            tableRows.push(row);\r\n        });\r\n\r\n        autoTable(doc, {\r\n            startY: 80,\r\n            head: [tableColumn],\r\n            body: tableRows,\r\n            theme: 'striped',\r\n            headStyles: { fillColor: [41, 128, 185] }, // Blue header\r\n        });\r\n\r\n        doc.addPage();\r\n        doc.setFont('helvetica', 'bold');\r\n        doc.setFontSize(16);\r\n        doc.text('Full Submitted Text', 14, 20);\r\n        \r\n        doc.setFont('helvetica', 'normal');\r\n        doc.setFontSize(9);\r\n        const splitText = doc.splitTextToSize(result.full_text, 180);\r\n        doc.text(splitText, 14, 30);\r\n\r\n        doc.save(`Plagiarism_Report_${file?.name || 'analysis'}.pdf`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n                <h2 className=\"text-2xl font-semibold\">Analysis Report</h2>\r\n                <button\r\n                    onClick={handleDownloadPDF}\r\n                    className=\"px-4 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700\"\r\n                >\r\n                    Download Report (PDF)\r\n                </button>\r\n            </div>\r\n            <div className=\"mb-6 border-b pb-4\">\r\n                <span className=\"text-gray-600 font-medium\">Overall Similarity Score:</span>\r\n                <span className=\"ml-2 text-3xl font-bold text-red-600\">{result.overall_score}%</span>\r\n            </div>\r\n            \r\n            {/* Render the new VisualReport component */}\r\n            {result.full_text_structured && (\r\n                <VisualReport structuredText={result.full_text_structured} />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AnalysisReport;"
        }
    ]
}