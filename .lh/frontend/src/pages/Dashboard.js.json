{
    "sourceFile": "frontend/src/pages/Dashboard.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1754054965698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1754056114213,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,10 @@\n const Dashboard = () => {\r\n     const [file, setFile] = useState(null);\r\n     const [analysisResult, setAnalysisResult] = useState(null);\r\n     const [message, setMessage] = useState('');\r\n+    const [rewriteSuggestions, setRewriteSuggestions] = useState({});\r\n+    const [rewritingIndex, setRewritingIndex] = useState(null);\r\n \r\n     const onFileChange = e => {\r\n         setFile(e.target.files[0]);\r\n     };\r\n@@ -13,8 +15,9 @@\n     const onFormSubmit = async e => {\r\n         e.preventDefault();\r\n         setMessage('Uploading and analyzing...');\r\n         setAnalysisResult(null);\r\n+        setRewriteSuggestions({});\r\n \r\n         if (!file) {\r\n             setMessage('Please select a file first.');\r\n             return;\r\n@@ -22,24 +25,43 @@\n \r\n         try {\r\n             const formData = new FormData();\r\n             formData.append('document', file);\r\n-            // Replace with your deployed backend URL if needed\r\n             const response = await axios.post('http://localhost:5000/api/documents/upload', formData);\r\n-\r\n             setAnalysisResult(response.data);\r\n             setMessage('Analysis Complete!');\r\n         } catch (error) {\r\n             console.error('File upload error:', error);\r\n             setMessage('Analysis failed.');\r\n         }\r\n     };\r\n \r\n+    const handleRewrite = async (sentence, index) => {\r\n+        setRewritingIndex(index);\r\n+        try {\r\n+            // Call the new /rewrite endpoint on the Python service\r\n+            const response = await axios.post('http://localhost:5001/rewrite', { sentence });\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: response.data.rewritten_text\r\n+            }));\r\n+        } catch (error) {\r\n+            console.error('Rewrite error:', error);\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: \"Error getting suggestion.\"\r\n+            }));\r\n+        } finally {\r\n+            setRewritingIndex(null);\r\n+        }\r\n+    };\r\n+\r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n                 <h2 className=\"text-2xl font-bold text-center\">Dashboard</h2>\r\n                 <form onSubmit={onFormSubmit} className=\"space-y-4\">\r\n+                    {/* ... form JSX is the same ... */}\r\n                     <div>\r\n                         <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700\">\r\n                             Upload your document\r\n                         </label>\r\n@@ -57,9 +79,8 @@\n                     >\r\n                         Upload & Analyze\r\n                     </button>\r\n                 </form>\r\n-\r\n                 {message && <p className=\"text-center text-sm text-gray-600 mt-4\">{message}</p>}\r\n             </div>\r\n \r\n             {analysisResult && (\r\n@@ -77,8 +98,22 @@\n                                     </p>\r\n                                     <p className=\"text-sm\">\r\n                                         <strong>Similarity:</strong> <span className=\"font-semibold text-indigo-600\">{section.similarity}% ({section.type})</span>\r\n                                     </p>\r\n+                                    <div className=\"mt-3\">\r\n+                                        <button\r\n+                                            onClick={() => handleRewrite(section.text, index)}\r\n+                                            disabled={rewritingIndex === index}\r\n+                                            className=\"text-sm font-medium text-indigo-600 hover:text-indigo-800 disabled:opacity-50 disabled:cursor-wait\"\r\n+                                        >\r\n+                                            {rewritingIndex === index ? 'Generating...' : 'âœ¨ Suggest Rewrite'}\r\n+                                        </button>\r\n+                                        {rewriteSuggestions[index] && (\r\n+                                            <div className=\"mt-2 p-3 bg-indigo-50 rounded-md\">\r\n+                                                <p className=\"text-sm text-gray-800\">{rewriteSuggestions[index]}</p>\r\n+                                            </div>\r\n+                                        )}\r\n+                                    </div>\r\n                                 </div>\r\n                             ))\r\n                         ) : (\r\n                             <p className=\"text-gray-500\">No plagiarized sections found.</p>\r\n"
                },
                {
                    "date": 1754063588907,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,27 +34,27 @@\n             setMessage('Analysis failed.');\r\n         }\r\n     };\r\n \r\n-    const handleRewrite = async (sentence, index) => {\r\n-        setRewritingIndex(index);\r\n-        try {\r\n-            // Call the new /rewrite endpoint on the Python service\r\n-            const response = await axios.post('http://localhost:5001/rewrite', { sentence });\r\n-            setRewriteSuggestions(prev => ({\r\n-                ...prev,\r\n-                [index]: response.data.rewritten_text\r\n-            }));\r\n-        } catch (error) {\r\n-            console.error('Rewrite error:', error);\r\n-            setRewriteSuggestions(prev => ({\r\n-                ...prev,\r\n-                [index]: \"Error getting suggestion.\"\r\n-            }));\r\n-        } finally {\r\n-            setRewritingIndex(null);\r\n-        }\r\n-    };\r\n+   const handleRewrite = async (sentence, index) => {\r\n+    setRewritingIndex(index);\r\n+    try {\r\n+        // Call the NEW Node.js backend endpoint\r\n+        const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n+        setRewriteSuggestions(prev => ({\r\n+            ...prev,\r\n+            [index]: response.data.rewritten_text\r\n+        }));\r\n+    } catch (error) {\r\n+        console.error('Rewrite error:', error);\r\n+        setRewriteSuggestions(prev => ({\r\n+            ...prev,\r\n+            [index]: \"Error getting suggestion.\"\r\n+        }));\r\n+    } finally {\r\n+        setRewritingIndex(null);\r\n+    }\r\n+};\r\n \r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n"
                },
                {
                    "date": 1754063596034,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,27 +34,27 @@\n             setMessage('Analysis failed.');\r\n         }\r\n     };\r\n \r\n-   const handleRewrite = async (sentence, index) => {\r\n-    setRewritingIndex(index);\r\n-    try {\r\n-        // Call the NEW Node.js backend endpoint\r\n-        const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n-        setRewriteSuggestions(prev => ({\r\n-            ...prev,\r\n-            [index]: response.data.rewritten_text\r\n-        }));\r\n-    } catch (error) {\r\n-        console.error('Rewrite error:', error);\r\n-        setRewriteSuggestions(prev => ({\r\n-            ...prev,\r\n-            [index]: \"Error getting suggestion.\"\r\n-        }));\r\n-    } finally {\r\n-        setRewritingIndex(null);\r\n-    }\r\n-};\r\n+    const handleRewrite = async (sentence, index) => {\r\n+        setRewritingIndex(index);\r\n+        try {\r\n+            // Call the new /rewrite endpoint on the Python service\r\n+            const response = await axios.post('http://localhost:5001/rewrite', { sentence });\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: response.data.rewritten_text\r\n+            }));\r\n+        } catch (error) {\r\n+            console.error('Rewrite error:', error);\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: \"Error getting suggestion.\"\r\n+            }));\r\n+        } finally {\r\n+            setRewritingIndex(null);\r\n+        }\r\n+    };\r\n \r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n"
                },
                {
                    "date": 1754063604378,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,27 +34,27 @@\n             setMessage('Analysis failed.');\r\n         }\r\n     };\r\n \r\n-    const handleRewrite = async (sentence, index) => {\r\n-        setRewritingIndex(index);\r\n-        try {\r\n-            // Call the new /rewrite endpoint on the Python service\r\n-            const response = await axios.post('http://localhost:5001/rewrite', { sentence });\r\n-            setRewriteSuggestions(prev => ({\r\n-                ...prev,\r\n-                [index]: response.data.rewritten_text\r\n-            }));\r\n-        } catch (error) {\r\n-            console.error('Rewrite error:', error);\r\n-            setRewriteSuggestions(prev => ({\r\n-                ...prev,\r\n-                [index]: \"Error getting suggestion.\"\r\n-            }));\r\n-        } finally {\r\n-            setRewritingIndex(null);\r\n-        }\r\n-    };\r\n+   const handleRewrite = async (sentence, index) => {\r\n+    setRewritingIndex(index);\r\n+    try {\r\n+        // Call the NEW Node.js backend endpoint\r\n+        const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n+        setRewriteSuggestions(prev => ({\r\n+            ...prev,\r\n+            [index]: response.data.rewritten_text\r\n+        }));\r\n+    } catch (error) {\r\n+        console.error('Rewrite error:', error);\r\n+        setRewriteSuggestions(prev => ({\r\n+            ...prev,\r\n+            [index]: \"Error getting suggestion.\"\r\n+        }));\r\n+    } finally {\r\n+        setRewritingIndex(null);\r\n+    }\r\n+};\r\n \r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n"
                },
                {
                    "date": 1754063616719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,27 +34,27 @@\n             setMessage('Analysis failed.');\r\n         }\r\n     };\r\n \r\n-   const handleRewrite = async (sentence, index) => {\r\n-    setRewritingIndex(index);\r\n-    try {\r\n-        // Call the NEW Node.js backend endpoint\r\n-        const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n-        setRewriteSuggestions(prev => ({\r\n-            ...prev,\r\n-            [index]: response.data.rewritten_text\r\n-        }));\r\n-    } catch (error) {\r\n-        console.error('Rewrite error:', error);\r\n-        setRewriteSuggestions(prev => ({\r\n-            ...prev,\r\n-            [index]: \"Error getting suggestion.\"\r\n-        }));\r\n-    } finally {\r\n-        setRewritingIndex(null);\r\n-    }\r\n-};\r\n+    const handleRewrite = async (sentence, index) => {\r\n+        setRewritingIndex(index);\r\n+        try {\r\n+            // Call the NEW Node.js backend endpoint\r\n+            const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: response.data.rewritten_text\r\n+            }));\r\n+        } catch (error) {\r\n+            console.error('Rewrite error:', error);\r\n+            setRewriteSuggestions(prev => ({\r\n+                ...prev,\r\n+                [index]: \"Error getting suggestion.\"\r\n+            }));\r\n+        } finally {\r\n+            setRewritingIndex(null);\r\n+        }\r\n+    };\r\n \r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n"
                },
                {
                    "date": 1754119963731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,45 +1,53 @@\n+// frontend/src/pages/Dashboard.js\r\n+\r\n import React, { useState } from 'react';\r\n import axios from 'axios';\r\n \r\n const Dashboard = () => {\r\n     const [file, setFile] = useState(null);\r\n     const [analysisResult, setAnalysisResult] = useState(null);\r\n     const [message, setMessage] = useState('');\r\n+    const [isLoading, setIsLoading] = useState(false); // 1. Add loading state\r\n     const [rewriteSuggestions, setRewriteSuggestions] = useState({});\r\n     const [rewritingIndex, setRewritingIndex] = useState(null);\r\n \r\n+\r\n     const onFileChange = e => {\r\n         setFile(e.target.files[0]);\r\n     };\r\n \r\n     const onFormSubmit = async e => {\r\n         e.preventDefault();\r\n+        setIsLoading(true); // 2. Set loading to true on submit\r\n         setMessage('Uploading and analyzing...');\r\n         setAnalysisResult(null);\r\n         setRewriteSuggestions({});\r\n \r\n         if (!file) {\r\n             setMessage('Please select a file first.');\r\n+            setIsLoading(false); // Reset loading state\r\n             return;\r\n         }\r\n \r\n         try {\r\n             const formData = new FormData();\r\n             formData.append('document', file);\r\n             const response = await axios.post('http://localhost:5000/api/documents/upload', formData);\r\n+\r\n             setAnalysisResult(response.data);\r\n             setMessage('Analysis Complete!');\r\n         } catch (error) {\r\n             console.error('File upload error:', error);\r\n             setMessage('Analysis failed.');\r\n+        } finally {\r\n+            setIsLoading(false); // 3. Set loading to false when done (success or fail)\r\n         }\r\n     };\r\n \r\n     const handleRewrite = async (sentence, index) => {\r\n         setRewritingIndex(index);\r\n         try {\r\n-            // Call the NEW Node.js backend endpoint\r\n             const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n             setRewriteSuggestions(prev => ({\r\n                 ...prev,\r\n                 [index]: response.data.rewritten_text\r\n@@ -59,29 +67,31 @@\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n                 <h2 className=\"text-2xl font-bold text-center\">Dashboard</h2>\r\n                 <form onSubmit={onFormSubmit} className=\"space-y-4\">\r\n-                    {/* ... form JSX is the same ... */}\r\n                     <div>\r\n                         <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700\">\r\n                             Upload your document\r\n                         </label>\r\n                         <div className=\"mt-1 flex items-center\">\r\n                             <input\r\n                                 type=\"file\"\r\n                                 onChange={onFileChange}\r\n-                                className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100\"\r\n+                                disabled={isLoading} // 4. Disable input during loading\r\n+                                className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 disabled:opacity-50\"\r\n                             />\r\n                         </div>\r\n                     </div>\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"w-full px-4 py-2 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\r\n+                        disabled={isLoading} // 5. Disable button during loading\r\n+                        className=\"w-full px-4 py-2 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed\"\r\n                     >\r\n-                        Upload & Analyze\r\n+                        {isLoading ? 'Analyzing...' : 'Upload & Analyze'}\r\n                     </button>\r\n                 </form>\r\n-                {message && <p className=\"text-center text-sm text-gray-600 mt-4\">{message}</p>}\r\n+\r\n+                {message && !isLoading && <p className=\"text-center text-sm text-gray-600 mt-4\">{message}</p>}\r\n             </div>\r\n \r\n             {analysisResult && (\r\n                 <div className=\"w-full max-w-2xl mx-auto mt-8 p-8 bg-white rounded-lg shadow-md\">\r\n@@ -124,5 +134,5 @@\n         </div>\r\n     );\r\n };\r\n \r\n-export default Dashboard;\n\\ No newline at end of file\n+export default Dashboard;\r\n"
                },
                {
                    "date": 1754121042427,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,32 +1,33 @@\n // frontend/src/pages/Dashboard.js\r\n \r\n-import React, { useState } from 'react';\r\n+import React, { useState, useRef } from 'react';\r\n import axios from 'axios';\r\n \r\n const Dashboard = () => {\r\n     const [file, setFile] = useState(null);\r\n     const [analysisResult, setAnalysisResult] = useState(null);\r\n     const [message, setMessage] = useState('');\r\n-    const [isLoading, setIsLoading] = useState(false); // 1. Add loading state\r\n+    const [isLoading, setIsLoading] = useState(false);\r\n     const [rewriteSuggestions, setRewriteSuggestions] = useState({});\r\n     const [rewritingIndex, setRewritingIndex] = useState(null);\r\n+    const fileInputRef = useRef(null); // 1. Add a ref for the file input\r\n \r\n \r\n     const onFileChange = e => {\r\n         setFile(e.target.files[0]);\r\n     };\r\n \r\n     const onFormSubmit = async e => {\r\n         e.preventDefault();\r\n-        setIsLoading(true); // 2. Set loading to true on submit\r\n+        setIsLoading(true);\r\n         setMessage('Uploading and analyzing...');\r\n         setAnalysisResult(null);\r\n         setRewriteSuggestions({});\r\n \r\n         if (!file) {\r\n             setMessage('Please select a file first.');\r\n-            setIsLoading(false); // Reset loading state\r\n+            setIsLoading(false);\r\n             return;\r\n         }\r\n \r\n         try {\r\n@@ -39,9 +40,9 @@\n         } catch (error) {\r\n             console.error('File upload error:', error);\r\n             setMessage('Analysis failed.');\r\n         } finally {\r\n-            setIsLoading(false); // 3. Set loading to false when done (success or fail)\r\n+            setIsLoading(false);\r\n         }\r\n     };\r\n \r\n     const handleRewrite = async (sentence, index) => {\r\n@@ -62,8 +63,19 @@\n             setRewritingIndex(null);\r\n         }\r\n     };\r\n \r\n+    // 2. Add a handler to clear the results\r\n+    const handleClear = () => {\r\n+        setFile(null);\r\n+        setAnalysisResult(null);\r\n+        setMessage('');\r\n+        setRewriteSuggestions({});\r\n+        if (fileInputRef.current) {\r\n+            fileInputRef.current.value = \"\"; // Reset the file input field\r\n+        }\r\n+    };\r\n+\r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n             <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n                 <h2 className=\"text-2xl font-bold text-center\">Dashboard</h2>\r\n@@ -74,17 +86,18 @@\n                         </label>\r\n                         <div className=\"mt-1 flex items-center\">\r\n                             <input\r\n                                 type=\"file\"\r\n+                                ref={fileInputRef} // 3. Attach the ref\r\n                                 onChange={onFileChange}\r\n-                                disabled={isLoading} // 4. Disable input during loading\r\n+                                disabled={isLoading}\r\n                                 className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 disabled:opacity-50\"\r\n                             />\r\n                         </div>\r\n                     </div>\r\n                     <button\r\n                         type=\"submit\"\r\n-                        disabled={isLoading} // 5. Disable button during loading\r\n+                        disabled={isLoading}\r\n                         className=\"w-full px-4 py-2 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed\"\r\n                     >\r\n                         {isLoading ? 'Analyzing...' : 'Upload & Analyze'}\r\n                     </button>\r\n@@ -94,9 +107,18 @@\n             </div>\r\n \r\n             {analysisResult && (\r\n                 <div className=\"w-full max-w-2xl mx-auto mt-8 p-8 bg-white rounded-lg shadow-md\">\r\n-                    <h3 className=\"text-xl font-bold mb-4\">Analysis Report</h3>\r\n+                    <div className=\"flex justify-between items-center mb-4\">\r\n+                        <h3 className=\"text-xl font-bold\">Analysis Report</h3>\r\n+                        {/* 4. Add the Clear button */}\r\n+                        <button \r\n+                            onClick={handleClear}\r\n+                            className=\"px-3 py-1 text-sm font-medium text-red-600 bg-red-100 rounded-md hover:bg-red-200\"\r\n+                        >\r\n+                            Clear\r\n+                        </button>\r\n+                    </div>\r\n                     <p className=\"text-lg mb-4\"><strong>Overall Plagiarism Score:</strong> {analysisResult.overall_score}%</p>\r\n                     <h4 className=\"text-lg font-semibold mb-2\">Flagged Sections:</h4>\r\n                     <div className=\"space-y-4\">\r\n                         {analysisResult.flagged_sections.length > 0 ? (\r\n"
                },
                {
                    "date": 1754121049472,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,4 @@\n-// frontend/src/pages/Dashboard.js\r\n \r\n import React, { useState, useRef } from 'react';\r\n import axios from 'axios';\r\n \r\n"
                },
                {
                    "date": 1754122784240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+// frontend/src/pages/Dashboard.js\r\n \r\n import React, { useState, useRef } from 'react';\r\n import axios from 'axios';\r\n \r\n@@ -8,9 +9,9 @@\n     const [message, setMessage] = useState('');\r\n     const [isLoading, setIsLoading] = useState(false);\r\n     const [rewriteSuggestions, setRewriteSuggestions] = useState({});\r\n     const [rewritingIndex, setRewritingIndex] = useState(null);\r\n-    const fileInputRef = useRef(null); // 1. Add a ref for the file input\r\n+    const fileInputRef = useRef(null);\r\n \r\n \r\n     const onFileChange = e => {\r\n         setFile(e.target.files[0]);\r\n@@ -62,22 +63,21 @@\n             setRewritingIndex(null);\r\n         }\r\n     };\r\n \r\n-    // 2. Add a handler to clear the results\r\n     const handleClear = () => {\r\n         setFile(null);\r\n         setAnalysisResult(null);\r\n         setMessage('');\r\n         setRewriteSuggestions({});\r\n         if (fileInputRef.current) {\r\n-            fileInputRef.current.value = \"\"; // Reset the file input field\r\n+            fileInputRef.current.value = \"\";\r\n         }\r\n     };\r\n \r\n     return (\r\n         <div className=\"container mx-auto mt-10 p-4\">\r\n-            <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n+            <div className=\"w-full max-w-2xl mx-auto p-6 sm:p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n                 <h2 className=\"text-2xl font-bold text-center\">Dashboard</h2>\r\n                 <form onSubmit={onFormSubmit} className=\"space-y-4\">\r\n                     <div>\r\n                         <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700\">\r\n@@ -85,9 +85,9 @@\n                         </label>\r\n                         <div className=\"mt-1 flex items-center\">\r\n                             <input\r\n                                 type=\"file\"\r\n-                                ref={fileInputRef} // 3. Attach the ref\r\n+                                ref={fileInputRef}\r\n                                 onChange={onFileChange}\r\n                                 disabled={isLoading}\r\n                                 className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 disabled:opacity-50\"\r\n                             />\r\n@@ -105,12 +105,11 @@\n                 {message && !isLoading && <p className=\"text-center text-sm text-gray-600 mt-4\">{message}</p>}\r\n             </div>\r\n \r\n             {analysisResult && (\r\n-                <div className=\"w-full max-w-2xl mx-auto mt-8 p-8 bg-white rounded-lg shadow-md\">\r\n+                <div className=\"w-full max-w-2xl mx-auto mt-8 p-6 sm:p-8 bg-white rounded-lg shadow-md\">\r\n                     <div className=\"flex justify-between items-center mb-4\">\r\n                         <h3 className=\"text-xl font-bold\">Analysis Report</h3>\r\n-                        {/* 4. Add the Clear button */}\r\n                         <button \r\n                             onClick={handleClear}\r\n                             className=\"px-3 py-1 text-sm font-medium text-red-600 bg-red-100 rounded-md hover:bg-red-200\"\r\n                         >\r\n"
                },
                {
                    "date": 1754123790728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,8 +11,13 @@\n     const [rewriteSuggestions, setRewriteSuggestions] = useState({});\r\n     const [rewritingIndex, setRewritingIndex] = useState(null);\r\n     const fileInputRef = useRef(null);\r\n \r\n+    // 1. Helper function to get the auth token from local storage\r\n+    const getAuthToken = () => {\r\n+        const user = JSON.parse(localStorage.getItem('user'));\r\n+        return user ? user.token : null;\r\n+    };\r\n \r\n     const onFileChange = e => {\r\n         setFile(e.target.files[0]);\r\n     };\r\n@@ -30,26 +35,58 @@\n             return;\r\n         }\r\n \r\n         try {\r\n+            const token = getAuthToken();\r\n+            if (!token) {\r\n+                setMessage('Authorization error. Please log in again.');\r\n+                setIsLoading(false);\r\n+                return;\r\n+            }\r\n+\r\n             const formData = new FormData();\r\n             formData.append('document', file);\r\n-            const response = await axios.post('http://localhost:5000/api/documents/upload', formData);\r\n+            \r\n+            // 2. Create a config object with the auth token in the headers\r\n+            const config = {\r\n+                headers: {\r\n+                    'Content-Type': 'multipart/form-data',\r\n+                    'x-auth-token': token\r\n+                }\r\n+            };\r\n \r\n+            // 3. Pass the config object with the request\r\n+            const response = await axios.post('http://localhost:5000/api/documents/upload', formData, config);\r\n+\r\n             setAnalysisResult(response.data);\r\n             setMessage('Analysis Complete!');\r\n         } catch (error) {\r\n             console.error('File upload error:', error);\r\n-            setMessage('Analysis failed.');\r\n+            setMessage('Analysis failed. Your session may have expired.');\r\n         } finally {\r\n             setIsLoading(false);\r\n         }\r\n     };\r\n \r\n     const handleRewrite = async (sentence, index) => {\r\n         setRewritingIndex(index);\r\n         try {\r\n-            const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence });\r\n+            const token = getAuthToken();\r\n+            if (!token) {\r\n+                setRewriteSuggestions(prev => ({ ...prev, [index]: \"Authorization error.\" }));\r\n+                return;\r\n+            }\r\n+\r\n+            // 4. Create config object for the rewrite request\r\n+            const config = {\r\n+                headers: {\r\n+                    'Content-Type': 'application/json',\r\n+                    'x-auth-token': token\r\n+                }\r\n+            };\r\n+\r\n+            // 5. Pass the config object with the request\r\n+            const response = await axios.post('http://localhost:5000/api/documents/rewrite', { sentence }, config);\r\n             setRewriteSuggestions(prev => ({\r\n                 ...prev,\r\n                 [index]: response.data.rewritten_text\r\n             }));\r\n"
                }
            ],
            "date": 1754054965698,
            "name": "Commit-0",
            "content": "import React, { useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Dashboard = () => {\r\n    const [file, setFile] = useState(null);\r\n    const [analysisResult, setAnalysisResult] = useState(null);\r\n    const [message, setMessage] = useState('');\r\n\r\n    const onFileChange = e => {\r\n        setFile(e.target.files[0]);\r\n    };\r\n\r\n    const onFormSubmit = async e => {\r\n        e.preventDefault();\r\n        setMessage('Uploading and analyzing...');\r\n        setAnalysisResult(null);\r\n\r\n        if (!file) {\r\n            setMessage('Please select a file first.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('document', file);\r\n            // Replace with your deployed backend URL if needed\r\n            const response = await axios.post('http://localhost:5000/api/documents/upload', formData);\r\n\r\n            setAnalysisResult(response.data);\r\n            setMessage('Analysis Complete!');\r\n        } catch (error) {\r\n            console.error('File upload error:', error);\r\n            setMessage('Analysis failed.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"container mx-auto mt-10 p-4\">\r\n            <div className=\"w-full max-w-2xl mx-auto p-8 space-y-6 bg-white rounded-lg shadow-md\">\r\n                <h2 className=\"text-2xl font-bold text-center\">Dashboard</h2>\r\n                <form onSubmit={onFormSubmit} className=\"space-y-4\">\r\n                    <div>\r\n                        <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700\">\r\n                            Upload your document\r\n                        </label>\r\n                        <div className=\"mt-1 flex items-center\">\r\n                            <input\r\n                                type=\"file\"\r\n                                onChange={onFileChange}\r\n                                className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"w-full px-4 py-2 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\r\n                    >\r\n                        Upload & Analyze\r\n                    </button>\r\n                </form>\r\n\r\n                {message && <p className=\"text-center text-sm text-gray-600 mt-4\">{message}</p>}\r\n            </div>\r\n\r\n            {analysisResult && (\r\n                <div className=\"w-full max-w-2xl mx-auto mt-8 p-8 bg-white rounded-lg shadow-md\">\r\n                    <h3 className=\"text-xl font-bold mb-4\">Analysis Report</h3>\r\n                    <p className=\"text-lg mb-4\"><strong>Overall Plagiarism Score:</strong> {analysisResult.overall_score}%</p>\r\n                    <h4 className=\"text-lg font-semibold mb-2\">Flagged Sections:</h4>\r\n                    <div className=\"space-y-4\">\r\n                        {analysisResult.flagged_sections.length > 0 ? (\r\n                            analysisResult.flagged_sections.map((section, index) => (\r\n                                <div key={index} className=\"border border-gray-200 p-4 rounded-md\">\r\n                                    <p className=\"text-gray-700 italic\">\"{section.text}\"</p>\r\n                                    <p className=\"text-sm mt-2\">\r\n                                        <strong>Source:</strong> <span className=\"text-gray-600\">{section.source}</span>\r\n                                    </p>\r\n                                    <p className=\"text-sm\">\r\n                                        <strong>Similarity:</strong> <span className=\"font-semibold text-indigo-600\">{section.similarity}% ({section.type})</span>\r\n                                    </p>\r\n                                </div>\r\n                            ))\r\n                        ) : (\r\n                            <p className=\"text-gray-500\">No plagiarized sections found.</p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;"
        }
    ]
}