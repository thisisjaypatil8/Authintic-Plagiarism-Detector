{
    "sourceFile": "backend/routes/auth.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1762431699624,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762431713276,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,90 @@\n-routes/auth.js\n\\ No newline at end of file\n+const express = require('express');\r\n+const bcrypt = require('bcryptjs');\r\n+const jwt = require('jsonwebtoken');\r\n+const User = require('../models/User');\r\n+const router = express.Router();\r\n+\r\n+// @route   POST /api/auth/register\r\n+// @desc    Register a new user and return token\r\n+router.post('/register', async (req, res) => {\r\n+    const { name, email, password } = req.body;\r\n+\r\n+    if (!name || !email || !password) {\r\n+        return res.status(400).json({ msg: 'All fields are required' });\r\n+    }\r\n+\r\n+    try {\r\n+        let user = await User.findOne({ email });\r\n+        if (user) {\r\n+            return res.status(400).json({ msg: 'User already exists' });\r\n+        }\r\n+\r\n+        user = new User({ name, email, password });\r\n+\r\n+        const salt = await bcrypt.genSalt(10);\r\n+        user.password = await bcrypt.hash(password, salt);\r\n+        await user.save();\r\n+\r\n+        // âœ… Automatically return JWT on registration\r\n+        const payload = {\r\n+            user: { id: user.id }\r\n+        };\r\n+\r\n+        jwt.sign(\r\n+            payload,\r\n+            process.env.JWT_SECRET,\r\n+            { expiresIn: '5h' },\r\n+            (err, token) => {\r\n+                if (err) throw err;\r\n+                res.status(201).json({\r\n+                    token,\r\n+                    msg: 'User registered successfully'\r\n+                });\r\n+            }\r\n+        );\r\n+    } catch (err) {\r\n+        console.error(err.message);\r\n+        res.status(500).send('Server error');\r\n+    }\r\n+});\r\n+\r\n+// @route   POST /api/auth/login\r\n+// @desc    Authenticate user & get token\r\n+router.post('/login', async (req, res) => {\r\n+    const { email, password } = req.body;\r\n+\r\n+    if (!email || !password) {\r\n+        return res.status(400).json({ msg: 'All fields are required' });\r\n+    }\r\n+\r\n+    try {\r\n+        const user = await User.findOne({ email });\r\n+        if (!user) {\r\n+            return res.status(400).json({ msg: 'Invalid credentials' });\r\n+        }\r\n+\r\n+        const isMatch = await bcrypt.compare(password, user.password);\r\n+        if (!isMatch) {\r\n+            return res.status(400).json({ msg: 'Invalid credentials' });\r\n+        }\r\n+\r\n+        const payload = {\r\n+            user: { id: user.id }\r\n+        };\r\n+\r\n+        jwt.sign(\r\n+            payload,\r\n+            process.env.JWT_SECRET,\r\n+            { expiresIn: '5h' },\r\n+            (err, token) => {\r\n+                if (err) throw err;\r\n+                res.json({ token });\r\n+            }\r\n+        );\r\n+    } catch (err) {\r\n+        console.error(err.message);\r\n+        res.status(500).send('Server error');\r\n+    }\r\n+});\r\n+\r\n+module.exports = router;\r\n"
                }
            ],
            "date": 1762431699624,
            "name": "Commit-0",
            "content": "routes/auth.js"
        }
    ]
}